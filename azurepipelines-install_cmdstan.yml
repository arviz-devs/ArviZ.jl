parameters:
- name: version
  type: string
  default: ''
- name: dir
  type: string
  default: ''

steps:
- bash: |
    set -o xtrace
    wget -P ${{ parameters.dir }} https://github.com/stan-dev/cmdstan/releases/download/v${{ parameters.version }}/cmdstan-${{ parameters.version }}.tar.gz
    tar -xzpf ${{ parameters.dir }}/cmdstan-${{ parameters.version }}.tar.gz -C ${{ parameters.dir }}
    make -C ${{ parameters.dir }}/cmdstan-${{ parameters.version }}/ build
  displayName: 'Download and build CmdStan'
