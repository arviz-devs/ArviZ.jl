{
  "hash": "c1cbd5d4e60b1d772485fa42e19738e7",
  "result": {
    "engine": "julia",
    "markdown": "---\ntitle: \"ArviZ Quickstart\"\n---\n\n## Set-up\n\nHere we add the necessary packages for this notebook and load a few we will use throughout.\n\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing ArviZ, ArviZPythonPlots, Distributions, LinearAlgebra, Random, StanSample, Turing\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    CondaPkg Found dependencies: /home/runner/.julia/packages/DimensionalData/48C1z/CondaPkg.toml\n    CondaPkg Found dependencies: /home/runner/.julia/packages/PythonCall/avYrV/CondaPkg.toml\n    CondaPkg Found dependencies: /home/runner/.julia/packages/ArviZPythonPlots/TzoLB/CondaPkg.toml\n    CondaPkg Found dependencies: /home/runner/.julia/packages/PythonPlot/oS8x4/CondaPkg.toml\n    CondaPkg Resolving changes\n             + arviz\n             + libstdcxx-ng\n             + matplotlib\n             + numpy\n             + openssl\n             + pandas\n             + python\n             + xarray\n    CondaPkg Initialising pixi\n             │ /home/runner/.julia/artifacts/cefba4912c2b400756d043a2563ef77a0088866b/bin/pixi\n             │ init\n             │ --format pixi\n             └ /home/runner/work/ArviZ.jl/ArviZ.jl/docs/.CondaPkg\n✔ Created /home/runner/work/ArviZ.jl/ArviZ.jl/docs/.CondaPkg/pixi.toml\n    CondaPkg Wrote /home/runner/work/ArviZ.jl/ArviZ.jl/docs/.CondaPkg/pixi.toml\n             │ [dependencies]\n             │ openssl = \">=3, <3.6, >=3, <3.6\"\n             │ libstdcxx-ng = \">=3.4,<15.0\"\n             │ matplotlib = \">=1\"\n             │ pandas = \"*\"\n             │ xarray = \"*\"\n             │ arviz = \">=0.15.0,<=0.18\"\n             │ numpy = \"*\"\n             │ \n             │     [dependencies.python]\n             │     channel = \"conda-forge\"\n             │     build = \"*cpython*\"\n             │     version = \">=3.8,<4\"\n             │ \n             │ [project]\n             │ name = \".CondaPkg\"\n             │ platforms = [\"linux-64\"]\n             │ channels = [\"conda-forge\"]\n             │ channel-priority = \"strict\"\n             └ description = \"automatically generated by CondaPkg.jl\"\n    CondaPkg Installing packages\n             │ /home/runner/.julia/artifacts/cefba4912c2b400756d043a2563ef77a0088866b/bin/pixi\n             │ install\n             └ --manifest-path /home/runner/work/ArviZ.jl/ArviZ.jl/docs/.CondaPkg/pixi.toml\n✔ The default environment has been installed.\n```\n:::\n:::\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\n# ArviZPythonPlots ships with style sheets!\nuse_style(\"arviz-darkgrid\")\n```\n:::\n\n\n\n## Get started with plotting\n\nTo plot with ArviZ, we need to load the [ArviZPythonPlots](https://julia.arviz.org/ArviZPythonPlots) package.\nArviZ is designed to be used with libraries like [Stan](https://github.com/StanJulia/Stan.jl), [Turing.jl](https://turinglang.org), and [Soss.jl](https://github.com/cscherrer/Soss.jl) but works fine with raw arrays.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nrng1 = Random.MersenneTwister(37772);\n```\n:::\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nplot_posterior(randn(rng1, 100_000));\n```\n:::\n\n\n\nPlotting a dictionary of arrays, ArviZ will interpret each key as the name of a different random variable.\nEach row of an array is treated as an independent series of draws from the variable, called a _chain_.\nBelow, we have 10 chains of 50 draws each for four different distributions.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\ns = (50, 10)\nplot_forest((\n    normal=randn(rng1, s),\n    gumbel=rand(rng1, Gumbel(), s),\n    student_t=rand(rng1, TDist(6), s),\n    exponential=rand(rng1, Exponential(), s),\n));\n```\n:::\n\n\n\n## Plotting with MCMCChains.jl's `Chains` objects produced by Turing.jl\n\nArviZ is designed to work well with high dimensional, labelled data.\nConsider the [eight schools model](https://statmodeling.stat.columbia.edu/2014/01/21/everything-need-know-bayesian-statistics-learned-eight-schools/), which roughly tries to measure the effectiveness of SAT classes at eight different schools.\nTo show off ArviZ's labelling, I give the schools the names of [a different eight schools](https://en.wikipedia.org/wiki/Eight_Schools_Association).\n\nThis model is small enough to write down, is hierarchical, and uses labelling.\nAdditionally, a centered parameterization causes [divergences](https://mc-stan.org/users/documentation/case-studies/divergences_and_bias.html) (which are interesting for illustration).\n\nFirst we create our data and set some sampling parameters.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nJ = 8\ny = [28.0, 8.0, -3.0, 7.0, -1.0, 1.0, 18.0, 12.0]\nσ = [15.0, 10.0, 16.0, 11.0, 9.0, 11.0, 10.0, 18.0]\nschools = [\n    \"Choate\",\n    \"Deerfield\",\n    \"Phillips Andover\",\n    \"Phillips Exeter\",\n    \"Hotchkiss\",\n    \"Lawrenceville\",\n    \"St. Paul's\",\n    \"Mt. Hermon\",\n]\nndraws = 1_000\nndraws_warmup = 1_000\nnchains = 4;\n```\n:::\n\n\n\nNow we write and run the model using Turing:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nTuring.@model function model_turing(y, σ, J=length(y))\n    μ ~ Normal(0, 5)\n    τ ~ truncated(Cauchy(0, 5), 0, Inf)\n    θ ~ filldist(Normal(μ, τ), J)\n    for i in 1:J\n        y[i] ~ Normal(θ[i], σ[i])\n    end\nend;\n```\n:::\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nrng2 = Random.MersenneTwister(16653);\n```\n:::\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nparam_mod_turing = model_turing(y, σ)\nsampler = NUTS(ndraws_warmup, 0.8)\n\nturing_chns = Turing.sample(\n    rng2, model_turing(y, σ), sampler, MCMCThreads(), ndraws, nchains\n);\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSampling (2 threads)   0%|                              |  ETA: N/A\n┌ Info: Found initial step size\n└   ϵ = 0.2\n┌ Info: Found initial step size\n└   ϵ = 0.41250000000000003\nSampling (2 threads)   0%|▏                             |  ETA: 0:47:39\nSampling (2 threads)   1%|▎                             |  ETA: 0:23:44\nSampling (2 threads)   2%|▌                             |  ETA: 0:15:45\nSampling (2 threads)   2%|▋                             |  ETA: 0:11:46\nSampling (2 threads)   2%|▊                             |  ETA: 0:09:23\nSampling (2 threads)   3%|▉                             |  ETA: 0:07:47\nSampling (2 threads)   4%|█                             |  ETA: 0:06:38\nSampling (2 threads)   4%|█▎                            |  ETA: 0:05:47\nSampling (2 threads)   4%|█▍                            |  ETA: 0:05:07\nSampling (2 threads)   5%|█▌                            |  ETA: 0:04:35\nSampling (2 threads)   6%|█▋                            |  ETA: 0:04:09\nSampling (2 threads)   6%|█▊                            |  ETA: 0:03:47\nSampling (2 threads)   6%|██                            |  ETA: 0:03:29\nSampling (2 threads)   7%|██▏                           |  ETA: 0:03:13\nSampling (2 threads)   8%|██▎                           |  ETA: 0:02:59\nSampling (2 threads)   8%|██▍                           |  ETA: 0:02:47\nSampling (2 threads)   8%|██▌                           |  ETA: 0:02:36\nSampling (2 threads)   9%|██▊                           |  ETA: 0:02:27\nSampling (2 threads)  10%|██▉                           |  ETA: 0:02:19\nSampling (2 threads)  10%|███                           |  ETA: 0:02:11\nSampling (2 threads)  10%|███▏                          |  ETA: 0:02:04\nSampling (2 threads)  11%|███▎                          |  ETA: 0:01:58\nSampling (2 threads)  12%|███▌                          |  ETA: 0:01:52\nSampling (2 threads)  12%|███▋                          |  ETA: 0:01:47\nSampling (2 threads)  12%|███▊                          |  ETA: 0:01:42\nSampling (2 threads)  13%|███▉                          |  ETA: 0:01:38\nSampling (2 threads)  14%|████                          |  ETA: 0:01:33\nSampling (2 threads)  14%|████▎                         |  ETA: 0:01:30\nSampling (2 threads)  14%|████▍                         |  ETA: 0:01:26\nSampling (2 threads)  15%|████▌                         |  ETA: 0:01:23\nSampling (2 threads)  16%|████▋                         |  ETA: 0:01:20\nSampling (2 threads)  16%|████▊                         |  ETA: 0:01:17\nSampling (2 threads)  16%|█████                         |  ETA: 0:01:14\nSampling (2 threads)  17%|█████▏                        |  ETA: 0:01:11\nSampling (2 threads)  18%|█████▎                        |  ETA: 0:01:09\nSampling (2 threads)  18%|█████▍                        |  ETA: 0:01:07\nSampling (2 threads)  18%|█████▌                        |  ETA: 0:01:05\nSampling (2 threads)  19%|█████▊                        |  ETA: 0:01:02\nSampling (2 threads)  20%|█████▉                        |  ETA: 0:01:01\nSampling (2 threads)  20%|██████                        |  ETA: 0:00:59\nSampling (2 threads)  20%|██████▏                       |  ETA: 0:00:57\nSampling (2 threads)  21%|██████▎                       |  ETA: 0:00:55\nSampling (2 threads)  22%|██████▌                       |  ETA: 0:00:54\nSampling (2 threads)  22%|██████▋                       |  ETA: 0:00:52\nSampling (2 threads)  22%|██████▊                       |  ETA: 0:00:51\nSampling (2 threads)  23%|██████▉                       |  ETA: 0:00:50\nSampling (2 threads)  24%|███████                       |  ETA: 0:00:48\nSampling (2 threads)  24%|███████▎                      |  ETA: 0:00:47\nSampling (2 threads)  24%|███████▍                      |  ETA: 0:00:46\nSampling (2 threads)  25%|███████▌                      |  ETA: 0:00:44\nSampling (2 threads)  26%|███████▋                      |  ETA: 0:00:43\nSampling (2 threads)  26%|███████▊                      |  ETA: 0:00:42\nSampling (2 threads)  26%|████████                      |  ETA: 0:00:41\nSampling (2 threads)  27%|████████▏                     |  ETA: 0:00:40\nSampling (2 threads)  28%|████████▎                     |  ETA: 0:00:39\nSampling (2 threads)  28%|████████▍                     |  ETA: 0:00:38\nSampling (2 threads)  28%|████████▌                     |  ETA: 0:00:37\nSampling (2 threads)  29%|████████▊                     |  ETA: 0:00:36\nSampling (2 threads)  30%|████████▉                     |  ETA: 0:00:36\nSampling (2 threads)  30%|█████████                     |  ETA: 0:00:35\nSampling (2 threads)  30%|█████████▏                    |  ETA: 0:00:34\nSampling (2 threads)  31%|█████████▎                    |  ETA: 0:00:33\nSampling (2 threads)  32%|█████████▌                    |  ETA: 0:00:32\nSampling (2 threads)  32%|█████████▋                    |  ETA: 0:00:32\nSampling (2 threads)  32%|█████████▊                    |  ETA: 0:00:31\nSampling (2 threads)  33%|█████████▉                    |  ETA: 0:00:30\nSampling (2 threads)  34%|██████████                    |  ETA: 0:00:30\nSampling (2 threads)  34%|██████████▎                   |  ETA: 0:00:29\nSampling (2 threads)  34%|██████████▍                   |  ETA: 0:00:28\nSampling (2 threads)  35%|██████████▌                   |  ETA: 0:00:28\nSampling (2 threads)  36%|██████████▋                   |  ETA: 0:00:27\nSampling (2 threads)  36%|██████████▊                   |  ETA: 0:00:27\nSampling (2 threads)  36%|███████████                   |  ETA: 0:00:26\nSampling (2 threads)  37%|███████████▏                  |  ETA: 0:00:26\nSampling (2 threads)  38%|███████████▎                  |  ETA: 0:00:25\nSampling (2 threads)  38%|███████████▍                  |  ETA: 0:00:24\nSampling (2 threads)  38%|███████████▌                  |  ETA: 0:00:24\nSampling (2 threads)  39%|███████████▊                  |  ETA: 0:00:23\nSampling (2 threads)  40%|███████████▉                  |  ETA: 0:00:23\nSampling (2 threads)  40%|████████████                  |  ETA: 0:00:23\nSampling (2 threads)  40%|████████████▏                 |  ETA: 0:00:22\nSampling (2 threads)  41%|████████████▎                 |  ETA: 0:00:22\nSampling (2 threads)  42%|████████████▌                 |  ETA: 0:00:21\nSampling (2 threads)  42%|████████████▋                 |  ETA: 0:00:21\nSampling (2 threads)  42%|████████████▊                 |  ETA: 0:00:20\nSampling (2 threads)  43%|████████████▉                 |  ETA: 0:00:20\nSampling (2 threads)  44%|█████████████                 |  ETA: 0:00:20\nSampling (2 threads)  44%|█████████████▎                |  ETA: 0:00:23\nSampling (2 threads)  44%|█████████████▍                |  ETA: 0:00:23\n┌ Info: Found initial step size\n└   ϵ = 1.0\nSampling (2 threads)  45%|█████████████▌                |  ETA: 0:00:22\nSampling (2 threads)  46%|█████████████▋                |  ETA: 0:00:22\nSampling (2 threads)  46%|█████████████▊                |  ETA: 0:00:21\nSampling (2 threads)  46%|██████████████                |  ETA: 0:00:21\nSampling (2 threads)  47%|██████████████▏               |  ETA: 0:00:21\nSampling (2 threads)  48%|██████████████▎               |  ETA: 0:00:20\nSampling (2 threads)  48%|██████████████▍               |  ETA: 0:00:20\nSampling (2 threads)  48%|██████████████▌               |  ETA: 0:00:19\nSampling (2 threads)  49%|██████████████▊               |  ETA: 0:00:19\nSampling (2 threads)  50%|██████████████▉               |  ETA: 0:00:19\nSampling (2 threads)  50%|███████████████               |  ETA: 0:00:18\nSampling (2 threads)  50%|███████████████▏              |  ETA: 0:00:18\nSampling (2 threads)  51%|███████████████▎              |  ETA: 0:00:18\nSampling (2 threads)  52%|███████████████▌              |  ETA: 0:00:17\nSampling (2 threads)  52%|███████████████▋              |  ETA: 0:00:17\nSampling (2 threads)  52%|███████████████▊              |  ETA: 0:00:17\nSampling (2 threads)  53%|███████████████▉              |  ETA: 0:00:16\nSampling (2 threads)  54%|████████████████              |  ETA: 0:00:16\nSampling (2 threads)  54%|████████████████▎             |  ETA: 0:00:16\nSampling (2 threads)  55%|████████████████▍             |  ETA: 0:00:15\nSampling (2 threads)  55%|████████████████▌             |  ETA: 0:00:15\nSampling (2 threads)  56%|████████████████▋             |  ETA: 0:00:15\nSampling (2 threads)  56%|████████████████▊             |  ETA: 0:00:15\nSampling (2 threads)  56%|█████████████████             |  ETA: 0:00:14\nSampling (2 threads)  57%|█████████████████▏            |  ETA: 0:00:14\nSampling (2 threads)  57%|█████████████████▎            |  ETA: 0:00:14\n┌ Info: Found initial step size\n└   ϵ = 0.2\nSampling (2 threads)  58%|█████████████████▍            |  ETA: 0:00:13\nSampling (2 threads)  58%|█████████████████▌            |  ETA: 0:00:13\nSampling (2 threads)  59%|█████████████████▊            |  ETA: 0:00:13\nSampling (2 threads)  60%|█████████████████▉            |  ETA: 0:00:13\nSampling (2 threads)  60%|██████████████████            |  ETA: 0:00:12\nSampling (2 threads)  60%|██████████████████▏           |  ETA: 0:00:12\nSampling (2 threads)  61%|██████████████████▎           |  ETA: 0:00:12\nSampling (2 threads)  62%|██████████████████▌           |  ETA: 0:00:12\nSampling (2 threads)  62%|██████████████████▋           |  ETA: 0:00:11\nSampling (2 threads)  62%|██████████████████▊           |  ETA: 0:00:11\nSampling (2 threads)  63%|██████████████████▉           |  ETA: 0:00:11\nSampling (2 threads)  64%|███████████████████           |  ETA: 0:00:11\nSampling (2 threads)  64%|███████████████████▎          |  ETA: 0:00:10\nSampling (2 threads)  64%|███████████████████▍          |  ETA: 0:00:10\nSampling (2 threads)  65%|███████████████████▌          |  ETA: 0:00:10\nSampling (2 threads)  66%|███████████████████▋          |  ETA: 0:00:10\nSampling (2 threads)  66%|███████████████████▊          |  ETA: 0:00:10\nSampling (2 threads)  66%|████████████████████          |  ETA: 0:00:09\nSampling (2 threads)  67%|████████████████████▏         |  ETA: 0:00:09\nSampling (2 threads)  68%|████████████████████▎         |  ETA: 0:00:09\nSampling (2 threads)  68%|████████████████████▍         |  ETA: 0:00:09\nSampling (2 threads)  68%|████████████████████▌         |  ETA: 0:00:09\nSampling (2 threads)  69%|████████████████████▊         |  ETA: 0:00:08\nSampling (2 threads)  70%|████████████████████▉         |  ETA: 0:00:08\nSampling (2 threads)  70%|█████████████████████         |  ETA: 0:00:08\nSampling (2 threads)  70%|█████████████████████▏        |  ETA: 0:00:08\nSampling (2 threads)  71%|█████████████████████▎        |  ETA: 0:00:08\nSampling (2 threads)  72%|█████████████████████▌        |  ETA: 0:00:07\nSampling (2 threads)  72%|█████████████████████▋        |  ETA: 0:00:07\nSampling (2 threads)  72%|█████████████████████▊        |  ETA: 0:00:07\nSampling (2 threads)  73%|█████████████████████▉        |  ETA: 0:00:07\nSampling (2 threads)  74%|██████████████████████        |  ETA: 0:00:07\nSampling (2 threads)  74%|██████████████████████▎       |  ETA: 0:00:07\nSampling (2 threads)  74%|██████████████████████▍       |  ETA: 0:00:06\nSampling (2 threads)  75%|██████████████████████▌       |  ETA: 0:00:06\nSampling (2 threads)  76%|██████████████████████▋       |  ETA: 0:00:06\nSampling (2 threads)  76%|██████████████████████▊       |  ETA: 0:00:06\nSampling (2 threads)  76%|███████████████████████       |  ETA: 0:00:06\nSampling (2 threads)  77%|███████████████████████▏      |  ETA: 0:00:06\nSampling (2 threads)  78%|███████████████████████▎      |  ETA: 0:00:05\nSampling (2 threads)  78%|███████████████████████▍      |  ETA: 0:00:05\nSampling (2 threads)  78%|███████████████████████▌      |  ETA: 0:00:05\nSampling (2 threads)  79%|███████████████████████▊      |  ETA: 0:00:05\nSampling (2 threads)  80%|███████████████████████▉      |  ETA: 0:00:05\nSampling (2 threads)  80%|████████████████████████      |  ETA: 0:00:05\nSampling (2 threads)  80%|████████████████████████▏     |  ETA: 0:00:05\nSampling (2 threads)  81%|████████████████████████▎     |  ETA: 0:00:04\nSampling (2 threads)  82%|████████████████████████▌     |  ETA: 0:00:04\nSampling (2 threads)  82%|████████████████████████▋     |  ETA: 0:00:04\nSampling (2 threads)  82%|████████████████████████▊     |  ETA: 0:00:04\nSampling (2 threads)  83%|████████████████████████▉     |  ETA: 0:00:04\nSampling (2 threads)  84%|█████████████████████████     |  ETA: 0:00:04\nSampling (2 threads)  84%|█████████████████████████▎    |  ETA: 0:00:04\nSampling (2 threads)  84%|█████████████████████████▍    |  ETA: 0:00:03\nSampling (2 threads)  85%|█████████████████████████▌    |  ETA: 0:00:03\nSampling (2 threads)  86%|█████████████████████████▋    |  ETA: 0:00:03\nSampling (2 threads)  86%|█████████████████████████▊    |  ETA: 0:00:03\nSampling (2 threads)  86%|██████████████████████████    |  ETA: 0:00:03\nSampling (2 threads)  87%|██████████████████████████▏   |  ETA: 0:00:03\nSampling (2 threads)  88%|██████████████████████████▎   |  ETA: 0:00:03\nSampling (2 threads)  88%|██████████████████████████▍   |  ETA: 0:00:03\nSampling (2 threads)  88%|██████████████████████████▌   |  ETA: 0:00:02\nSampling (2 threads)  89%|██████████████████████████▊   |  ETA: 0:00:02\nSampling (2 threads)  90%|██████████████████████████▉   |  ETA: 0:00:02\nSampling (2 threads)  90%|███████████████████████████   |  ETA: 0:00:02\nSampling (2 threads)  90%|███████████████████████████▏  |  ETA: 0:00:02\nSampling (2 threads)  91%|███████████████████████████▎  |  ETA: 0:00:02\nSampling (2 threads)  92%|███████████████████████████▌  |  ETA: 0:00:02\nSampling (2 threads)  92%|███████████████████████████▋  |  ETA: 0:00:02\nSampling (2 threads)  92%|███████████████████████████▊  |  ETA: 0:00:02\nSampling (2 threads)  93%|███████████████████████████▉  |  ETA: 0:00:01\nSampling (2 threads)  94%|████████████████████████████  |  ETA: 0:00:01\nSampling (2 threads)  94%|████████████████████████████▎ |  ETA: 0:00:01\nSampling (2 threads)  94%|████████████████████████████▍ |  ETA: 0:00:01\nSampling (2 threads)  95%|████████████████████████████▌ |  ETA: 0:00:01\nSampling (2 threads)  96%|████████████████████████████▋ |  ETA: 0:00:01\nSampling (2 threads)  96%|████████████████████████████▊ |  ETA: 0:00:01\nSampling (2 threads)  96%|█████████████████████████████ |  ETA: 0:00:01\nSampling (2 threads)  97%|█████████████████████████████▏|  ETA: 0:00:01\nSampling (2 threads)  98%|█████████████████████████████▎|  ETA: 0:00:00\nSampling (2 threads)  98%|█████████████████████████████▍|  ETA: 0:00:00\nSampling (2 threads)  98%|█████████████████████████████▌|  ETA: 0:00:00\nSampling (2 threads)  99%|█████████████████████████████▊|  ETA: 0:00:00\nSampling (2 threads) 100%|█████████████████████████████▉|  ETA: 0:00:00\nSampling (2 threads) 100%|██████████████████████████████| Time: 0:00:19\nSampling (2 threads) 100%|██████████████████████████████| Time: 0:00:19\n```\n:::\n:::\n\n\n\nMost ArviZ functions work fine with `Chains` objects from Turing:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nplot_autocorr(turing_chns; var_names=(:μ, :τ));\n```\n:::\n\n\n\n### Convert to `InferenceData`\n\nFor much more powerful querying, analysis and plotting, we can use built-in ArviZ utilities to convert `Chains` objects to multidimensional data structures with named dimensions and indices.\nNote that for such dimensions, the information is not contained in `Chains`, so we need to provide it.\n\nArviZ is built to work with [`InferenceData`](@ref), and the more *groups* it has access to, the more powerful analyses it can perform.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nidata_turing_post = from_mcmcchains(\n    turing_chns;\n    coords=(; school=schools),\n    dims=NamedTuple(k => (:school,) for k in (:y, :σ, :θ)),\n    library=\"Turing\",\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>InferenceData<details>\n<summary>posterior</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :μ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :τ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :θ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 2 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:39:52.91&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>sample_stats</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :energy          </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :n_steps         </span><span class=\"sgr90\"> eltype: </span>Int64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :diverging       </span><span class=\"sgr90\"> eltype: </span>Bool<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :max_energy_error</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :loglikelihood   </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :energy_error    </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :is_accept       </span><span class=\"sgr90\"> eltype: </span>Bool<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :logprior        </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :log_density     </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :tree_depth      </span><span class=\"sgr90\"> eltype: </span>Int64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :step_size       </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :acceptance_rate </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :lp              </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :step_size_nom   </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 2 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:39:52.832&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n</div>\n```\n:::\n:::\n\n\n\nEach group is a [`Dataset`](@ref), a `DimensionalData.AbstractDimStack` that can be used identically to a [`DimensionalData.Dimstack`](https://rafaqz.github.io/DimensionalData.jl/stable/stacks).\nWe can view a summary of the dataset.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nidata_turing_post.posterior\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\n┌ 1000×4×8 Dataset ┐\n├──────────────────┴──────────────────────────────────────────── dims ┐\n  ↓ draw,\n  → chain,\n  ↗ school Categorical{String} [\"Choate\", …, \"Mt. Hermon\"] Unordered\n├───────────────────────────────────────────────────────────── layers ┤\n  :μ eltype: Float64 dims: draw, chain size: 1000×4\n  :τ eltype: Float64 dims: draw, chain size: 1000×4\n  :θ eltype: Float64 dims: draw, chain, school size: 1000×4×8\n├─────────────────────────────────────────────────────────── metadata ┤\n  Dict{String, Any} with 2 entries:\n  \"created_at\"        => \"2025-08-19T09:39:52.91\"\n  \"inference_library\" => \"Turing\"\n```\n:::\n:::\n\n\n\nHere is a plot of the trace. Note the intelligent labels.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nplot_trace(idata_turing_post);\n```\n:::\n\n\n\nWe can also generate summary stats...\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nsummarystats(idata_turing_post)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<table><caption style = \"text-align: left;\">SummaryStats</caption><thead><tr class = \"header headerLastRow\"><th class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\"></th><th style = \"text-align: right;\">mean</th><th style = \"text-align: right;\">std</th><th style = \"text-align: right;\">hdi_3%</th><th style = \"text-align: right;\">hdi_97%</th><th style = \"text-align: right;\">mcse_mean</th><th style = \"text-align: right;\">mcse_std</th><th style = \"text-align: right;\">ess_tail</th><th style = \"text-align: right;\">ess_bulk</th><th style = \"text-align: right;\">rhat</th></tr></thead><tbody><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">μ</td><td style = \"text-align: right;\">4.6</td><td style = \"text-align: right;\">3.3</td><td style = \"text-align: right;\">-1.65</td><td style = \"text-align: right;\">11.1</td><td style = \"text-align: right;\">0.15</td><td style = \"text-align: right;\">0.13</td><td style = \"text-align: right;\">245</td><td style = \"text-align: right;\">505</td><td style = \"text-align: right;\">1.01</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">τ</td><td style = \"text-align: right;\">4.4</td><td style = \"text-align: right;\">3.4</td><td style = \"text-align: right;\">0.501</td><td style = \"text-align: right;\">10.6</td><td style = \"text-align: right;\">0.22</td><td style = \"text-align: right;\">0.099</td><td style = \"text-align: right;\">78</td><td style = \"text-align: right;\">130</td><td style = \"text-align: right;\">1.04</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[Choate]</td><td style = \"text-align: right;\">6.9</td><td style = \"text-align: right;\">6.1</td><td style = \"text-align: right;\">-4.51</td><td style = \"text-align: right;\">18.5</td><td style = \"text-align: right;\">0.21</td><td style = \"text-align: right;\">0.19</td><td style = \"text-align: right;\">1467</td><td style = \"text-align: right;\">805</td><td style = \"text-align: right;\">1.01</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[Deerfield]</td><td style = \"text-align: right;\">5.4</td><td style = \"text-align: right;\">5.0</td><td style = \"text-align: right;\">-3.92</td><td style = \"text-align: right;\">15.0</td><td style = \"text-align: right;\">0.15</td><td style = \"text-align: right;\">0.12</td><td style = \"text-align: right;\">1946</td><td style = \"text-align: right;\">1087</td><td style = \"text-align: right;\">1.02</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[Phillips Andover]</td><td style = \"text-align: right;\">4.0</td><td style = \"text-align: right;\">6.0</td><td style = \"text-align: right;\">-7.99</td><td style = \"text-align: right;\">14.7</td><td style = \"text-align: right;\">0.17</td><td style = \"text-align: right;\">0.21</td><td style = \"text-align: right;\">1696</td><td style = \"text-align: right;\">1090</td><td style = \"text-align: right;\">1.01</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[Phillips Exeter]</td><td style = \"text-align: right;\">5.1</td><td style = \"text-align: right;\">5.0</td><td style = \"text-align: right;\">-4.99</td><td style = \"text-align: right;\">14.2</td><td style = \"text-align: right;\">0.15</td><td style = \"text-align: right;\">0.14</td><td style = \"text-align: right;\">1992</td><td style = \"text-align: right;\">1020</td><td style = \"text-align: right;\">1.02</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[Hotchkiss]</td><td style = \"text-align: right;\">3.5</td><td style = \"text-align: right;\">5.1</td><td style = \"text-align: right;\">-6.09</td><td style = \"text-align: right;\">13.1</td><td style = \"text-align: right;\">0.18</td><td style = \"text-align: right;\">0.15</td><td style = \"text-align: right;\">396</td><td style = \"text-align: right;\">775</td><td style = \"text-align: right;\">1.01</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[Lawrenceville]</td><td style = \"text-align: right;\">4.1</td><td style = \"text-align: right;\">5.1</td><td style = \"text-align: right;\">-5.73</td><td style = \"text-align: right;\">13.8</td><td style = \"text-align: right;\">0.16</td><td style = \"text-align: right;\">0.15</td><td style = \"text-align: right;\">1609</td><td style = \"text-align: right;\">953</td><td style = \"text-align: right;\">1.01</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[St. Paul&apos;s]</td><td style = \"text-align: right;\">7.0</td><td style = \"text-align: right;\">5.3</td><td style = \"text-align: right;\">-2.50</td><td style = \"text-align: right;\">17.4</td><td style = \"text-align: right;\">0.19</td><td style = \"text-align: right;\">0.15</td><td style = \"text-align: right;\">1411</td><td style = \"text-align: right;\">757</td><td style = \"text-align: right;\">1.01</td></tr><tr><td class = \"rowLabel\" style = \"font-weight: bold; text-align: left;\">θ[Mt. Hermon]</td><td style = \"text-align: right;\">5.2</td><td style = \"text-align: right;\">5.9</td><td style = \"text-align: right;\">-5.38</td><td style = \"text-align: right;\">16.5</td><td style = \"text-align: right;\">0.17</td><td style = \"text-align: right;\">0.18</td><td style = \"text-align: right;\">1813</td><td style = \"text-align: right;\">1080</td><td style = \"text-align: right;\">1.02</td></tr></tbody></table>\n```\n:::\n:::\n\n\n\n...and examine the energy distribution of the Hamiltonian sampler.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nplot_energy(idata_turing_post);\n```\n:::\n\n\n\n### Additional information in Turing.jl\n\nWith a few more steps, we can use Turing to compute additional useful groups to add to the `InferenceData`.\n\nTo sample from the prior, one simply calls `sample` but with the `Prior` sampler:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nprior = Turing.sample(rng2, param_mod_turing, Prior(), ndraws);\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSampling   0%|                                          |  ETA: N/A\nSampling   0%|▎                                         |  ETA: 0:01:26\nSampling   1%|▍                                         |  ETA: 0:00:43\nSampling   2%|▋                                         |  ETA: 0:00:28\nSampling   2%|▉                                         |  ETA: 0:00:21\nSampling   2%|█                                         |  ETA: 0:00:17\nSampling   3%|█▎                                        |  ETA: 0:00:14\nSampling   4%|█▌                                        |  ETA: 0:00:12\nSampling   4%|█▋                                        |  ETA: 0:00:10\nSampling   4%|█▉                                        |  ETA: 0:00:09\nSampling   5%|██▏                                       |  ETA: 0:00:08\nSampling   6%|██▎                                       |  ETA: 0:00:08\nSampling   6%|██▌                                       |  ETA: 0:00:07\nSampling   6%|██▊                                       |  ETA: 0:00:06\nSampling   7%|███                                       |  ETA: 0:00:06\nSampling   8%|███▏                                      |  ETA: 0:00:05\nSampling   8%|███▍                                      |  ETA: 0:00:05\nSampling   8%|███▋                                      |  ETA: 0:00:05\nSampling   9%|███▊                                      |  ETA: 0:00:04\nSampling  10%|████                                      |  ETA: 0:00:04\nSampling  10%|████▎                                     |  ETA: 0:00:04\nSampling  10%|████▍                                     |  ETA: 0:00:04\nSampling  11%|████▋                                     |  ETA: 0:00:04\nSampling  12%|████▉                                     |  ETA: 0:00:03\nSampling  12%|█████                                     |  ETA: 0:00:03\nSampling  12%|█████▎                                    |  ETA: 0:00:03\nSampling  13%|█████▌                                    |  ETA: 0:00:03\nSampling  14%|█████▋                                    |  ETA: 0:00:03\nSampling  14%|█████▉                                    |  ETA: 0:00:03\nSampling  14%|██████▏                                   |  ETA: 0:00:03\nSampling  15%|██████▎                                   |  ETA: 0:00:03\nSampling  16%|██████▌                                   |  ETA: 0:00:02\nSampling  16%|██████▊                                   |  ETA: 0:00:02\nSampling  16%|██████▉                                   |  ETA: 0:00:02\nSampling  17%|███████▏                                  |  ETA: 0:00:02\nSampling  18%|███████▍                                  |  ETA: 0:00:02\nSampling  18%|███████▌                                  |  ETA: 0:00:02\nSampling  18%|███████▊                                  |  ETA: 0:00:02\nSampling  19%|████████                                  |  ETA: 0:00:02\nSampling  20%|████████▎                                 |  ETA: 0:00:02\nSampling  20%|████████▍                                 |  ETA: 0:00:02\nSampling  20%|████████▋                                 |  ETA: 0:00:02\nSampling  21%|████████▉                                 |  ETA: 0:00:02\nSampling  22%|█████████                                 |  ETA: 0:00:02\nSampling  22%|█████████▎                                |  ETA: 0:00:02\nSampling  22%|█████████▌                                |  ETA: 0:00:02\nSampling  23%|█████████▋                                |  ETA: 0:00:02\nSampling  24%|█████████▉                                |  ETA: 0:00:02\nSampling  24%|██████████▏                               |  ETA: 0:00:01\nSampling  24%|██████████▎                               |  ETA: 0:00:01\nSampling  25%|██████████▌                               |  ETA: 0:00:01\nSampling  26%|██████████▊                               |  ETA: 0:00:01\nSampling  26%|██████████▉                               |  ETA: 0:00:01\nSampling  26%|███████████▏                              |  ETA: 0:00:01\nSampling  27%|███████████▍                              |  ETA: 0:00:01\nSampling  28%|███████████▌                              |  ETA: 0:00:01\nSampling  28%|███████████▊                              |  ETA: 0:00:01\nSampling  28%|████████████                              |  ETA: 0:00:01\nSampling  29%|████████████▏                             |  ETA: 0:00:01\nSampling  30%|████████████▍                             |  ETA: 0:00:01\nSampling  30%|████████████▋                             |  ETA: 0:00:01\nSampling  30%|████████████▊                             |  ETA: 0:00:01\nSampling  31%|█████████████                             |  ETA: 0:00:01\nSampling  32%|█████████████▎                            |  ETA: 0:00:01\nSampling  32%|█████████████▌                            |  ETA: 0:00:01\nSampling  32%|█████████████▋                            |  ETA: 0:00:01\nSampling  33%|█████████████▉                            |  ETA: 0:00:01\nSampling  34%|██████████████▏                           |  ETA: 0:00:01\nSampling  34%|██████████████▎                           |  ETA: 0:00:01\nSampling  34%|██████████████▌                           |  ETA: 0:00:01\nSampling  35%|██████████████▊                           |  ETA: 0:00:01\nSampling  36%|██████████████▉                           |  ETA: 0:00:01\nSampling  36%|███████████████▏                          |  ETA: 0:00:01\nSampling  36%|███████████████▍                          |  ETA: 0:00:01\nSampling  37%|███████████████▌                          |  ETA: 0:00:01\nSampling  38%|███████████████▊                          |  ETA: 0:00:01\nSampling  38%|████████████████                          |  ETA: 0:00:01\nSampling  38%|████████████████▏                         |  ETA: 0:00:01\nSampling  39%|████████████████▍                         |  ETA: 0:00:01\nSampling  40%|████████████████▋                         |  ETA: 0:00:01\nSampling  40%|████████████████▊                         |  ETA: 0:00:01\nSampling  40%|█████████████████                         |  ETA: 0:00:01\nSampling  41%|█████████████████▎                        |  ETA: 0:00:01\nSampling  42%|█████████████████▍                        |  ETA: 0:00:01\nSampling  42%|█████████████████▋                        |  ETA: 0:00:01\nSampling  42%|█████████████████▉                        |  ETA: 0:00:01\nSampling  43%|██████████████████                        |  ETA: 0:00:01\nSampling  44%|██████████████████▎                       |  ETA: 0:00:01\nSampling  44%|██████████████████▌                       |  ETA: 0:00:01\nSampling  44%|██████████████████▊                       |  ETA: 0:00:01\nSampling  45%|██████████████████▉                       |  ETA: 0:00:01\nSampling  46%|███████████████████▏                      |  ETA: 0:00:01\nSampling  46%|███████████████████▍                      |  ETA: 0:00:01\nSampling  46%|███████████████████▌                      |  ETA: 0:00:01\nSampling  47%|███████████████████▊                      |  ETA: 0:00:01\nSampling  48%|████████████████████                      |  ETA: 0:00:01\nSampling  48%|████████████████████▏                     |  ETA: 0:00:01\nSampling  48%|████████████████████▍                     |  ETA: 0:00:01\nSampling  49%|████████████████████▋                     |  ETA: 0:00:01\nSampling  50%|████████████████████▊                     |  ETA: 0:00:01\nSampling  50%|█████████████████████                     |  ETA: 0:00:00\nSampling  50%|█████████████████████▎                    |  ETA: 0:00:00\nSampling  51%|█████████████████████▍                    |  ETA: 0:00:00\nSampling  52%|█████████████████████▋                    |  ETA: 0:00:00\nSampling  52%|█████████████████████▉                    |  ETA: 0:00:00\nSampling  52%|██████████████████████                    |  ETA: 0:00:00\nSampling  53%|██████████████████████▎                   |  ETA: 0:00:00\nSampling  54%|██████████████████████▌                   |  ETA: 0:00:00\nSampling  54%|██████████████████████▋                   |  ETA: 0:00:00\nSampling  55%|██████████████████████▉                   |  ETA: 0:00:00\nSampling  55%|███████████████████████▏                  |  ETA: 0:00:00\nSampling  56%|███████████████████████▎                  |  ETA: 0:00:00\nSampling  56%|███████████████████████▌                  |  ETA: 0:00:00\nSampling  56%|███████████████████████▊                  |  ETA: 0:00:00\nSampling  57%|████████████████████████                  |  ETA: 0:00:00\nSampling  57%|████████████████████████▏                 |  ETA: 0:00:00\nSampling  58%|████████████████████████▍                 |  ETA: 0:00:00\nSampling  58%|████████████████████████▋                 |  ETA: 0:00:00\nSampling  59%|████████████████████████▊                 |  ETA: 0:00:00\nSampling  60%|█████████████████████████                 |  ETA: 0:00:00\nSampling  60%|█████████████████████████▎                |  ETA: 0:00:00\nSampling  60%|█████████████████████████▍                |  ETA: 0:00:00\nSampling  61%|█████████████████████████▋                |  ETA: 0:00:00\nSampling  62%|█████████████████████████▉                |  ETA: 0:00:00\nSampling  62%|██████████████████████████                |  ETA: 0:00:00\nSampling  62%|██████████████████████████▎               |  ETA: 0:00:00\nSampling  63%|██████████████████████████▌               |  ETA: 0:00:00\nSampling  64%|██████████████████████████▋               |  ETA: 0:00:00\nSampling  64%|██████████████████████████▉               |  ETA: 0:00:00\nSampling  64%|███████████████████████████▏              |  ETA: 0:00:00\nSampling  65%|███████████████████████████▎              |  ETA: 0:00:00\nSampling  66%|███████████████████████████▌              |  ETA: 0:00:00\nSampling  66%|███████████████████████████▊              |  ETA: 0:00:00\nSampling  66%|███████████████████████████▉              |  ETA: 0:00:00\nSampling  67%|████████████████████████████▏             |  ETA: 0:00:00\nSampling  68%|████████████████████████████▍             |  ETA: 0:00:00\nSampling  68%|████████████████████████████▌             |  ETA: 0:00:00\nSampling  68%|████████████████████████████▊             |  ETA: 0:00:00\nSampling  69%|█████████████████████████████             |  ETA: 0:00:00\nSampling  70%|█████████████████████████████▎            |  ETA: 0:00:00\nSampling  70%|█████████████████████████████▍            |  ETA: 0:00:00\nSampling  70%|█████████████████████████████▋            |  ETA: 0:00:00\nSampling  71%|█████████████████████████████▉            |  ETA: 0:00:00\nSampling  72%|██████████████████████████████            |  ETA: 0:00:00\nSampling  72%|██████████████████████████████▎           |  ETA: 0:00:00\nSampling  72%|██████████████████████████████▌           |  ETA: 0:00:00\nSampling  73%|██████████████████████████████▋           |  ETA: 0:00:00\nSampling  74%|██████████████████████████████▉           |  ETA: 0:00:00\nSampling  74%|███████████████████████████████▏          |  ETA: 0:00:00\nSampling  74%|███████████████████████████████▎          |  ETA: 0:00:00\nSampling  75%|███████████████████████████████▌          |  ETA: 0:00:00\nSampling  76%|███████████████████████████████▊          |  ETA: 0:00:00\nSampling  76%|███████████████████████████████▉          |  ETA: 0:00:00\nSampling  76%|████████████████████████████████▏         |  ETA: 0:00:00\nSampling  77%|████████████████████████████████▍         |  ETA: 0:00:00\nSampling  78%|████████████████████████████████▌         |  ETA: 0:00:00\nSampling  78%|████████████████████████████████▊         |  ETA: 0:00:00\nSampling  78%|█████████████████████████████████         |  ETA: 0:00:00\nSampling  79%|█████████████████████████████████▏        |  ETA: 0:00:00\nSampling  80%|█████████████████████████████████▍        |  ETA: 0:00:00\nSampling  80%|█████████████████████████████████▋        |  ETA: 0:00:00\nSampling  80%|█████████████████████████████████▊        |  ETA: 0:00:00\nSampling  81%|██████████████████████████████████        |  ETA: 0:00:00\nSampling  82%|██████████████████████████████████▎       |  ETA: 0:00:00\nSampling  82%|██████████████████████████████████▌       |  ETA: 0:00:00\nSampling  82%|██████████████████████████████████▋       |  ETA: 0:00:00\nSampling  83%|██████████████████████████████████▉       |  ETA: 0:00:00\nSampling  84%|███████████████████████████████████▏      |  ETA: 0:00:00\nSampling  84%|███████████████████████████████████▎      |  ETA: 0:00:00\nSampling  84%|███████████████████████████████████▌      |  ETA: 0:00:00\nSampling  85%|███████████████████████████████████▊      |  ETA: 0:00:00\nSampling  86%|███████████████████████████████████▉      |  ETA: 0:00:00\nSampling  86%|████████████████████████████████████▏     |  ETA: 0:00:00\nSampling  86%|████████████████████████████████████▍     |  ETA: 0:00:00\nSampling  87%|████████████████████████████████████▌     |  ETA: 0:00:00\nSampling  88%|████████████████████████████████████▊     |  ETA: 0:00:00\nSampling  88%|█████████████████████████████████████     |  ETA: 0:00:00\nSampling  88%|█████████████████████████████████████▏    |  ETA: 0:00:00\nSampling  89%|█████████████████████████████████████▍    |  ETA: 0:00:00\nSampling  90%|█████████████████████████████████████▋    |  ETA: 0:00:00\nSampling  90%|█████████████████████████████████████▊    |  ETA: 0:00:00\nSampling  90%|██████████████████████████████████████    |  ETA: 0:00:00\nSampling  91%|██████████████████████████████████████▎   |  ETA: 0:00:00\nSampling  92%|██████████████████████████████████████▍   |  ETA: 0:00:00\nSampling  92%|██████████████████████████████████████▋   |  ETA: 0:00:00\nSampling  92%|██████████████████████████████████████▉   |  ETA: 0:00:00\nSampling  93%|███████████████████████████████████████   |  ETA: 0:00:00\nSampling  94%|███████████████████████████████████████▎  |  ETA: 0:00:00\nSampling  94%|███████████████████████████████████████▌  |  ETA: 0:00:00\nSampling  94%|███████████████████████████████████████▊  |  ETA: 0:00:00\nSampling  95%|███████████████████████████████████████▉  |  ETA: 0:00:00\nSampling  96%|████████████████████████████████████████▏ |  ETA: 0:00:00\nSampling  96%|████████████████████████████████████████▍ |  ETA: 0:00:00\nSampling  96%|████████████████████████████████████████▌ |  ETA: 0:00:00\nSampling  97%|████████████████████████████████████████▊ |  ETA: 0:00:00\nSampling  98%|█████████████████████████████████████████ |  ETA: 0:00:00\nSampling  98%|█████████████████████████████████████████▏|  ETA: 0:00:00\nSampling  98%|█████████████████████████████████████████▍|  ETA: 0:00:00\nSampling  99%|█████████████████████████████████████████▋|  ETA: 0:00:00\nSampling 100%|█████████████████████████████████████████▊|  ETA: 0:00:00\nSampling 100%|██████████████████████████████████████████| Time: 0:00:00\nSampling 100%|██████████████████████████████████████████| Time: 0:00:00\n```\n:::\n:::\n\n\n\nTo draw from the prior and posterior predictive distributions we can instantiate a \"predictive model\", i.e. a Turing model but with the observations set to `missing`, and then calling `predict` on the predictive model and the previously drawn samples:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\n# Instantiate the predictive model\nparam_mod_predict = model_turing(similar(y, Missing), σ)\n# and then sample!\nprior_predictive = Turing.predict(rng2, param_mod_predict, prior)\nposterior_predictive = Turing.predict(rng2, param_mod_predict, turing_chns);\n```\n:::\n\n\n\nAnd to extract the pointwise log-likelihoods, which is useful if you want to compute metrics such as [`loo`](@ref),\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nlog_likelihood = let\n    log_likelihood = Turing.pointwise_loglikelihoods(\n        param_mod_turing, MCMCChains.get_sections(turing_chns, :parameters)\n    )\n    # Ensure the ordering of the loglikelihoods matches the ordering of `posterior_predictive`\n    ynames = string.(keys(posterior_predictive))\n    log_likelihood_y = getindex.(Ref(log_likelihood), ynames)\n    (; y=cat(log_likelihood_y...; dims=3))\nend;\n```\n:::\n\n\n\nThis can then be included in the [`from_mcmcchains`](@ref) call from above:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nidata_turing = from_mcmcchains(\n    turing_chns;\n    posterior_predictive,\n    log_likelihood,\n    prior,\n    prior_predictive,\n    observed_data=(; y),\n    coords=(; school=schools),\n    dims=NamedTuple(k => (:school,) for k in (:y, :σ, :θ)),\n    library=Turing,\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>InferenceData<details>\n<summary>posterior</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :μ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :τ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :θ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:24.737&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>posterior_predictive</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :y</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:24.274&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>log_likelihood</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :y</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:24.577&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>sample_stats</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :energy          </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :n_steps         </span><span class=\"sgr90\"> eltype: </span>Int64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :diverging       </span><span class=\"sgr90\"> eltype: </span>Bool<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :max_energy_error</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :loglikelihood   </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :energy_error    </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :is_accept       </span><span class=\"sgr90\"> eltype: </span>Bool<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :logprior        </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :log_density     </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :tree_depth      </span><span class=\"sgr90\"> eltype: </span>Int64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :step_size       </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :acceptance_rate </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :lp              </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :step_size_nom   </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:24.737&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>prior</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :μ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :τ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :θ</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:25.306&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>prior_predictive</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :y</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:25.138&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>sample_stats_prior</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├────────────────┴───────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>\n<span class=\"sgr90\">├──────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :logprior     </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :lp           </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :loglikelihood</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">1</span>\n<span class=\"sgr90\">├────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:25.233&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n<details>\n<summary>observed_data</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">8-element </span>Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├───────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#ff875f\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├────────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :y</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">8</span>\n<span class=\"sgr90\">├──────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 3 entries:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:40:25.503&quot;\n  &quot;inference_library_version&quot; =&gt; &quot;0.40.2&quot;\n  &quot;inference_library&quot; =&gt; &quot;Turing&quot;\n</pre></details>\n</div>\n```\n:::\n:::\n\n\n\nThen we can for example compute the expected *leave-one-out (LOO)* predictive density, which is an estimate of the out-of-distribution predictive fit of the model:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nloo(idata_turing) # higher ELPD is better\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nPSISLOOResult with estimates\n elpd  elpd_mcse    p  p_mcse \n  -31        1.4  0.9    0.33\n\nand PSISResult with 1000 draws, 4 chains, and 8 parameters\nPareto shape (k) diagnostic values:\n                    Count      Min. ESS\n (-Inf, 0.5]  good  6 (75.0%)  313\n  (0.5, 0.7]  okay  2 (25.0%)  1049\n```\n:::\n:::\n\n\n\nIf the model is well-calibrated, i.e. it replicates the true generative process well, the CDF of the pointwise LOO values should be similarly distributed to a uniform distribution.\nThis can be inspected visually:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nplot_loo_pit(idata_turing; y=:y, ecdf=true);\n```\n:::\n\n\n\n## Plotting with Stan.jl outputs\n\nStanSample.jl comes with built-in support for producing `InferenceData` outputs.\n\nHere is the same centered eight schools model in Stan:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nschools_code = \"\"\"\ndata {\n    int<lower=0> J;\n    array[J] real y;\n    array[J] real<lower=0> sigma;\n}\n\nparameters {\n    real mu;\n    real<lower=0> tau;\n    array[J] real theta;\n}\n\nmodel {\n    mu ~ normal(0, 5);\n    tau ~ cauchy(0, 5);\n    theta ~ normal(mu, tau);\n    y ~ normal(theta, sigma);\n}\n\ngenerated quantities {\n    vector[J] log_lik;\n    vector[J] y_hat;\n    for (j in 1:J) {\n        log_lik[j] = normal_lpdf(y[j] | theta[j], sigma[j]);\n        y_hat[j] = normal_rng(theta[j], sigma[j]);\n    }\n}\n\"\"\"\n\nschools_data = Dict(\"J\" => J, \"y\" => y, \"sigma\" => σ)\nidata_stan = mktempdir() do path\n    stan_model = SampleModel(\"schools\", schools_code, path)\n    _ = stan_sample(\n        stan_model;\n        data=schools_data,\n        num_chains=nchains,\n        num_warmups=ndraws_warmup,\n        num_samples=ndraws,\n        seed=28983,\n        summary=false,\n    )\n    return StanSample.inferencedata(\n        stan_model;\n        posterior_predictive_var=:y_hat,\n        observed_data=(; y),\n        log_likelihood_var=:log_lik,\n        coords=(; school=schools),\n        dims=NamedTuple(\n            k => (:school,) for k in (:y, :sigma, :theta, :log_lik, :y_hat)\n        ),\n    )\nend\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[ Info: /tmp/jl_q9qkTM/schools.stan updated.\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>InferenceData<details>\n<summary>posterior</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :mu   </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :tau  </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :theta</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 1 entry:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:41:06.675&quot;\n</pre></details>\n<details>\n<summary>posterior_predictive</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :y_hat</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 1 entry:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:41:06.262&quot;\n</pre></details>\n<details>\n<summary>log_likelihood</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├──────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>,\n  <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>,\n  <span class=\"sgr38_5\" style=\"color:#5fd7ff\">↗ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#5fd7ff\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├───────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :log_lik</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span>, <span class=\"sgr38_5\" style=\"color:#5fd7ff\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>×<span class=\"sgr38_5\" style=\"color:#5fd7ff\">8</span>\n<span class=\"sgr90\">├─────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 1 entry:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:41:06.584&quot;\n</pre></details>\n<details>\n<summary>sample_stats</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span> Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├────────────────┴─────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">→ chain</span>\n<span class=\"sgr90\">├────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :tree_depth     </span><span class=\"sgr90\"> eltype: </span>Int64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :energy         </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :diverging      </span><span class=\"sgr90\"> eltype: </span>Bool<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :acceptance_rate</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :n_steps        </span><span class=\"sgr90\"> eltype: </span>Int64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :lp             </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :step_size      </span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">draw</span>, <span class=\"sgr38_5\" style=\"color:#0087d7\">chain</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">1000</span>×<span class=\"sgr38_5\" style=\"color:#0087d7\">4</span>\n<span class=\"sgr90\">├──────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 1 entry:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:41:06.401&quot;\n</pre></details>\n<details>\n<summary>observed_data</summary>\n<pre><span class=\"sgr90\">┌ </span><span class=\"sgr38_5\" style=\"color:#ff875f\">8-element </span>Dataset<span class=\"sgr90\"> ┐</span>\n<span class=\"sgr90\">├───────────────────┴──────────────────────────────────────────── dims ┐</span>\n  <span class=\"sgr38_5\" style=\"color:#ff875f\">↓ school</span> Categorical{String} <span class=\"sgr38_5\" style=\"color:#ff875f\">[&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;]</span> <span class=\"sgr38_5\" style=\"color:#808080\">Unordered</span>\n<span class=\"sgr90\">├────────────────────────────────────────────────────────────── layers ┤</span>\n<span class=\"sgr38_5\" style=\"color:#00afaf\">  :y</span><span class=\"sgr90\"> eltype: </span>Float64<span class=\"sgr90\"> dims: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">school</span><span class=\"sgr90\"> size: </span><span class=\"sgr38_5\" style=\"color:#ff875f\">8</span>\n<span class=\"sgr90\">├──────────────────────────────────────────────────────────── metadata ┤</span>\n  Dict{String, Any} with 1 entry:\n  &quot;created_at&quot; =&gt; &quot;2025-08-19T09:41:06.731&quot;\n</pre></details>\n</div>\n```\n:::\n:::\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nplot_density(idata_stan; var_names=(:mu, :tau));\n```\n:::\n\n\n\nHere is a plot showing where the Hamiltonian sampler had divergences:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nplot_pair(\n    idata_stan;\n    coords=Dict(:school => [\"Choate\", \"Deerfield\", \"Phillips Andover\"]),\n    divergences=true,\n);\n```\n:::\n\n\n\n## Environment\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing Pkg\nPkg.status()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStatus `~/work/ArviZ.jl/ArviZ.jl/docs/Project.toml`\n⌃ [cbdf2221] AlgebraOfGraphics v0.11.4\n  [131c737c] ArviZ v0.12.3 `~/work/ArviZ.jl/ArviZ.jl`\n  [2f96bb34] ArviZExampleData v0.2.0\n  [4a6e88f0] ArviZPythonPlots v0.1.9\n  [13f3f980] CairoMakie v0.15.6\n  [a93c6f00] DataFrames v1.7.0\n  [0703355e] DimensionalData v0.29.23\n  [31c24e10] Distributions v0.25.120\n  [e30172f5] Documenter v1.14.1\n  [f6006082] EvoTrees v0.17.4\n  [b5cf5a8d] InferenceObjects v0.4.12\n  [be115224] MCMCDiagnosticTools v0.3.15\n  [a7f614a8] MLJBase v1.8.2\n  [614be32b] MLJIteration v0.6.3\n  [ce719bf2] PSIS v0.9.8\n  [7f36be82] PosteriorStats v0.2.8\n  [c1514b29] StanSample v7.10.2\n  [a19d573c] StatisticalMeasures v0.2.1\n  [10745b16] Statistics v1.11.1\n  [2913bbd2] StatsBase v0.34.6\n  [fce5fe82] Turing v0.40.2\n  [f43a241f] Downloads v1.6.0\n  [37e2e46d] LinearAlgebra v1.11.0\nInfo Packages marked with ⌃ have new versions available and may be upgradable.\n```\n:::\n:::\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nversioninfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nJulia Version 1.11.6\nCommit 9615af0f269 (2025-07-09 12:58 UTC)\nBuild Info:\n  Official https://julialang.org/ release\nPlatform Info:\n  OS: Linux (x86_64-linux-gnu)\n  CPU: 4 × AMD EPYC 7763 64-Core Processor\n  WORD_SIZE: 64\n  LLVM: libLLVM-16.0.6 (ORCJIT, znver3)\nThreads: 2 default, 0 interactive, 1 GC (on 4 virtual cores)\nEnvironment:\n  JULIA_PKG_SERVER_REGISTRY_PREFERENCE = eager\n  JULIA_PROJECT = @.\n  JULIA_NUM_THREADS = 2\n  JULIA_LOAD_PATH = @:@stdlib\n  JULIA_PYTHONCALL_EXE = /home/runner/work/ArviZ.jl/ArviZ.jl/docs/.CondaPkg/.pixi/envs/default/bin/python\n```\n:::\n:::\n\n\n\n",
    "supporting": [
      "quickstart_files"
    ],
    "filters": []
  }
}