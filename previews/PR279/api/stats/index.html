<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stats · ArviZ.jl</title><meta name="title" content="Stats · ArviZ.jl"/><meta property="og:title" content="Stats · ArviZ.jl"/><meta property="twitter:title" content="Stats · ArviZ.jl"/><meta name="description" content="Documentation for ArviZ.jl."/><meta property="og:description" content="Documentation for ArviZ.jl."/><meta property="twitter:description" content="Documentation for ArviZ.jl."/><meta property="og:url" content="stable/api/stats/"/><meta property="twitter:url" content="stable/api/stats/"/><link rel="canonical" href="stable/api/stats/"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-W1G68W77YV"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-W1G68W77YV', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="ArviZ.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="ArviZ.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../quickstart/">Quickstart</a></li><li><a class="tocitem" href="../../working_with_inference_data/">Working with <code>InferenceData</code></a></li><li><a class="tocitem" href="../../creating_custom_plots/">Creating custom plots</a></li></ul></li><li><span class="tocitem">API</span><ul><li class="is-active"><a class="tocitem" href>Stats</a><ul class="internal"><li><a class="tocitem" href="#Summary-statistics"><span>Summary statistics</span></a></li><li><a class="tocitem" href="#General-statistics"><span>General statistics</span></a></li><li><a class="tocitem" href="#Pareto-smoothed-importance-sampling"><span>Pareto-smoothed importance sampling</span></a></li><li><a class="tocitem" href="#LOO-and-WAIC"><span>LOO and WAIC</span></a></li><li><a class="tocitem" href="#Model-comparison"><span>Model comparison</span></a></li><li><a class="tocitem" href="#Predictive-checks"><span>Predictive checks</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../data/">Data</a></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">InferenceObjects</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../inference_data/">InferenceData</a></li><li><a class="tocitem" href="../dataset/">Dataset</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Stats</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stats</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/arviz-devs/ArviZ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/arviz-devs/ArviZ.jl/blob/main/docs/src/api/stats.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="stats-api"><a class="docs-heading-anchor" href="#stats-api">Stats</a><a id="stats-api-1"></a><a class="docs-heading-anchor-permalink" href="#stats-api" title="Permalink"></a></h1><ul><li><a href="#PSIS.PSISResult"><code>PSIS.PSISResult</code></a></li><li><a href="#PosteriorStats.AbstractELPDResult"><code>PosteriorStats.AbstractELPDResult</code></a></li><li><a href="#PosteriorStats.AbstractModelWeightsMethod"><code>PosteriorStats.AbstractModelWeightsMethod</code></a></li><li><a href="#PosteriorStats.BootstrappedPseudoBMA"><code>PosteriorStats.BootstrappedPseudoBMA</code></a></li><li><a href="#PosteriorStats.ModelComparisonResult"><code>PosteriorStats.ModelComparisonResult</code></a></li><li><a href="#PosteriorStats.PSISLOOResult"><code>PosteriorStats.PSISLOOResult</code></a></li><li><a href="#PosteriorStats.PseudoBMA"><code>PosteriorStats.PseudoBMA</code></a></li><li><a href="#PosteriorStats.Stacking"><code>PosteriorStats.Stacking</code></a></li><li><a href="#PosteriorStats.SummaryStats"><code>PosteriorStats.SummaryStats</code></a></li><li><a href="#PosteriorStats.WAICResult"><code>PosteriorStats.WAICResult</code></a></li><li><a href="#PSIS.PSISPlots.paretoshapeplot"><code>PSIS.PSISPlots.paretoshapeplot</code></a></li><li><a href="#PSIS.ess_is"><code>PSIS.ess_is</code></a></li><li><a href="#PSIS.psis"><code>PSIS.psis</code></a></li><li><a href="#PSIS.psis!"><code>PSIS.psis!</code></a></li><li><a href="#PosteriorStats.compare"><code>PosteriorStats.compare</code></a></li><li><a href="#PosteriorStats.default_diagnostics"><code>PosteriorStats.default_diagnostics</code></a></li><li><a href="#PosteriorStats.default_stats"><code>PosteriorStats.default_stats</code></a></li><li><a href="#PosteriorStats.default_summary_stats"><code>PosteriorStats.default_summary_stats</code></a></li><li><a href="#PosteriorStats.elpd_estimates"><code>PosteriorStats.elpd_estimates</code></a></li><li><a href="#PosteriorStats.hdi"><code>PosteriorStats.hdi</code></a></li><li><a href="#PosteriorStats.hdi!"><code>PosteriorStats.hdi!</code></a></li><li><a href="#PosteriorStats.information_criterion"><code>PosteriorStats.information_criterion</code></a></li><li><a href="#PosteriorStats.loo"><code>PosteriorStats.loo</code></a></li><li><a href="#PosteriorStats.loo_pit"><code>PosteriorStats.loo_pit</code></a></li><li><a href="#PosteriorStats.model_weights"><code>PosteriorStats.model_weights</code></a></li><li><a href="#PosteriorStats.r2_score"><code>PosteriorStats.r2_score</code></a></li><li><a href="#PosteriorStats.smooth_data"><code>PosteriorStats.smooth_data</code></a></li><li><a href="#PosteriorStats.summarize"><code>PosteriorStats.summarize</code></a></li><li><a href="#PosteriorStats.waic"><code>PosteriorStats.waic</code></a></li><li><a href="#StatsBase.summarystats"><code>StatsBase.summarystats</code></a></li></ul><h2 id="Summary-statistics"><a class="docs-heading-anchor" href="#Summary-statistics">Summary statistics</a><a id="Summary-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-statistics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.SummaryStats" href="#PosteriorStats.SummaryStats"><code>PosteriorStats.SummaryStats</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SummaryStats{D, V&lt;:(AbstractVector)}</code></pre><p>A container for a column table of values computed by <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p><p>This object implements the Tables and TableTraits column table interfaces. It has a custom <code>show</code> method.</p><p><code>SummaryStats</code> behaves like an <code>OrderedDict</code> of columns, where the columns can be accessed using either <code>Symbol</code>s or a 1-based integer index.</p><ul><li><p><code>name::String</code>: The name of the collection of summary statistics, used as the table title in display.</p></li><li><p><code>data::Any</code>: The summary statistics for each parameter. It must implement the Tables interface.</p></li><li><p><code>parameter_names::AbstractVector</code>: Names of the parameters</p></li></ul><pre><code class="nohighlight hljs">SummaryStats([name::String,] data[, parameter_names])
SummaryStats(data[, parameter_names]; name::String=&quot;SummaryStats&quot;)</code></pre><p>Construct a <code>SummaryStats</code> from tabular <code>data</code> with optional stats <code>name</code> and <code>param_names</code>.</p><p><code>data</code> must not contain a column <code>:parameter</code>, as this is reserved for the parameter names, which are always in the first column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/summarize.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.default_summary_stats" href="#PosteriorStats.default_summary_stats"><code>PosteriorStats.default_summary_stats</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_summary_stats(focus=Statistics.mean; kwargs...)</code></pre><p>Combinatiton of <a href="#PosteriorStats.default_stats"><code>default_stats</code></a> and <a href="#PosteriorStats.default_diagnostics"><code>default_diagnostics</code></a> to be used with <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/summarize.jl#L287-L292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.default_stats" href="#PosteriorStats.default_stats"><code>PosteriorStats.default_stats</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_stats(focus=Statistics.mean; prob_interval=0.94, kwargs...)</code></pre><p>Default statistics to be computed with <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p><p>The value of <code>focus</code> determines the statistics to be returned:</p><ul><li><code>Statistics.mean</code>: <code>mean</code>, <code>std</code>, <code>hdi_3%</code>, <code>hdi_97%</code></li><li><code>Statistics.median</code>: <code>median</code>, <code>mad</code>, <code>eti_3%</code>, <code>eti_97%</code></li></ul><p>If <code>prob_interval</code> is set to a different value than the default, then different HDI and ETI statistics are computed accordingly. <a href="#PosteriorStats.hdi"><code>hdi</code></a> refers to the highest-density interval, while <code>eti</code> refers to the equal-tailed interval (i.e. the credible interval computed from symmetric quantiles).</p><p>See also: <a href="#PosteriorStats.hdi"><code>hdi</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/summarize.jl#L297-L312">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.default_diagnostics" href="#PosteriorStats.default_diagnostics"><code>PosteriorStats.default_diagnostics</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_diagnostics(focus=Statistics.mean; kwargs...)</code></pre><p>Default diagnostics to be computed with <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p><p>The value of <code>focus</code> determines the diagnostics to be returned:</p><ul><li><code>Statistics.mean</code>: <code>mcse_mean</code>, <code>mcse_std</code>, <code>ess_tail</code>, <code>ess_bulk</code>, <code>rhat</code></li><li><code>Statistics.median</code>: <code>mcse_median</code>, <code>ess_tail</code>, <code>ess_bulk</code>, <code>rhat</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/summarize.jl#L337-L345">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.summarize" href="#PosteriorStats.summarize"><code>PosteriorStats.summarize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">summarize(data, stats_funs...; name=&quot;SummaryStats&quot;, [var_names]) -&gt; SummaryStats</code></pre><p>Compute the summary statistics in <code>stats_funs</code> on each param in <code>data</code>.</p><p><code>stats_funs</code> is a collection of functions that reduces a matrix with shape <code>(draws, chains)</code> to a scalar or a collection of scalars. Alternatively, an item in <code>stats_funs</code> may be a <code>Pair</code> of the form <code>name =&gt; fun</code> specifying the name to be used for the statistic or of the form <code>(name1, ...) =&gt; fun</code> when the function returns a collection. When the function returns a collection, the names in this latter format must be provided.</p><p>If no stats functions are provided, then those specified in <a href="#PosteriorStats.default_summary_stats"><code>default_summary_stats</code></a> are computed.</p><p><code>var_names</code> specifies the names of the parameters in <code>data</code>. If not provided, the names are inferred from <code>data</code>.</p><p>To support computing summary statistics from a custom object, overload this method specifying the type of <code>data</code>.</p><p>See also <a href="#PosteriorStats.SummaryStats"><code>SummaryStats</code></a>, <a href="#PosteriorStats.default_summary_stats"><code>default_summary_stats</code></a>, <a href="#PosteriorStats.default_stats"><code>default_stats</code></a>, <a href="#PosteriorStats.default_diagnostics"><code>default_diagnostics</code></a>.</p><p><strong>Examples</strong></p><p>Compute <code>mean</code>, <code>std</code> and the Monte Carlo standard error (MCSE) of the mean estimate:</p><pre><code class="language-julia-repl hljs">julia&gt; using Statistics, StatsBase

julia&gt; x = randn(1000, 4, 3) .+ reshape(0:10:20, 1, 1, :);

julia&gt; summarize(x, mean, std, :mcse_mean =&gt; sem; name=&quot;Mean/Std&quot;)
Mean/Std
       mean    std  mcse_mean
 1   0.0003  0.989      0.016
 2  10.02    0.988      0.016
 3  19.98    0.988      0.016</code></pre><p>Avoid recomputing the mean by using <code>mean_and_std</code>, and provide parameter names:</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x, (:mean, :std) =&gt; mean_and_std, mad; var_names=[:a, :b, :c])
SummaryStats
         mean    std    mad
 a   0.000275  0.989  0.978
 b  10.0       0.988  0.995
 c  20.0       0.988  0.979</code></pre><p>Note that when an estimator and its MCSE are both computed, the MCSE is used to determine the number of significant digits that will be displayed.</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x; var_names=[:a, :b, :c])
SummaryStats
       mean   std  hdi_3%  hdi_97%  mcse_mean  mcse_std  ess_tail  ess_bulk  r ⋯
 a   0.0003  0.99   -1.92     1.78      0.016     0.012      3567      3663  1 ⋯
 b  10.02    0.99    8.17    11.9       0.016     0.011      3841      3906  1 ⋯
 c  19.98    0.99   18.1     21.9       0.016     0.012      3892      3749  1 ⋯
                                                                1 column omitted</code></pre><p>Compute just the statistics with an 89% HDI on all parameters, and provide the parameter names:</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x, default_stats(; prob_interval=0.89)...; var_names=[:a, :b, :c])
SummaryStats
         mean    std  hdi_5.5%  hdi_94.5%
 a   0.000275  0.989     -1.63       1.52
 b  10.0       0.988      8.53      11.6
 c  20.0       0.988     18.5       21.6</code></pre><p>Compute the summary stats focusing on <code>Statistics.median</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x, default_summary_stats(median)...; var_names=[:a, :b, :c])
SummaryStats
    median    mad  eti_3%  eti_97%  mcse_median  ess_tail  ess_median  rhat
 a   0.004  0.978   -1.83     1.89        0.020      3567        3336  1.00
 b  10.02   0.995    8.17    11.9         0.023      3841        3787  1.00
 c  19.99   0.979   18.1     21.9         0.020      3892        3829  1.00</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/summarize.jl#L162-L247">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StatsBase.summarystats" href="#StatsBase.summarystats"><code>StatsBase.summarystats</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">summarystats(data::InferenceData; group=:posterior, kwargs...) -&gt; SummaryStats
summarystats(data::Dataset; kwargs...) -&gt; SummaryStats</code></pre><p>Compute default summary statistics for the data using <a href="#PosteriorStats.summarize"><code>PosteriorStats.summarize</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/InferenceObjects.jl/blob/v0.4.12/ext/InferenceObjectsPosteriorStatsExt/summarize.jl#L1-L7">source</a></section></article><h2 id="General-statistics"><a class="docs-heading-anchor" href="#General-statistics">General statistics</a><a id="General-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#General-statistics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.hdi" href="#PosteriorStats.hdi"><code>PosteriorStats.hdi</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hdi(samples::AbstractArray{&lt;:Real}; prob=0.94) -&gt; (; lower, upper)</code></pre><p>Estimate the unimodal highest density interval (HDI) of <code>samples</code> for the probability <code>prob</code>.</p><p>The HDI is the minimum width Bayesian credible interval (BCI). That is, it is the smallest possible interval containing <code>(100*prob)</code>% of the probability mass.<sup class="footnote-reference"><a id="citeref-Hyndman1996" href="#footnote-Hyndman1996">[Hyndman1996]</a></sup></p><p><code>samples</code> is an array of shape <code>(draws[, chains[, params...]])</code>. If multiple parameters are present, then <code>lower</code> and <code>upper</code> are arrays with the shape <code>(params...,)</code>, computed separately for each marginal.</p><p>This implementation uses the algorithm of <sup class="footnote-reference"><a id="citeref-ChenShao1999" href="#footnote-ChenShao1999">[ChenShao1999]</a></sup>.</p><div class="admonition is-info" id="Note-29594ae9440e24af"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-29594ae9440e24af" title="Permalink"></a></header><div class="admonition-body"><p>Any default value of <code>prob</code> is arbitrary. The default value of <code>prob=0.94</code> instead of a more common default like <code>prob=0.95</code> is chosen to reminder the user of this arbitrariness.</p></div></div><p><strong>Examples</strong></p><p>Here we calculate the 83% HDI for a normal random variable:</p><pre><code class="language-julia-repl hljs">julia&gt; x = randn(2_000);

julia&gt; hdi(x; prob=0.83) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :lower =&gt; -1.38266
  :upper =&gt; 1.25982</code></pre><p>We can also calculate the HDI for a 3-dimensional array of samples:</p><pre><code class="language-julia-repl hljs">julia&gt; x = randn(1_000, 1, 1) .+ reshape(0:5:10, 1, 1, :);

julia&gt; hdi(x) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :lower =&gt; [-1.9674, 3.0326, 8.0326]
  :upper =&gt; [1.90028, 6.90028, 11.9003]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/hdi.jl#L1-L53">source</a></section><section><div><pre><code class="language-julia hljs">hdi(data::InferenceData; kwargs...) -&gt; Dataset
hdi(data::Dataset; kwargs...) -&gt; Dataset</code></pre><p>Calculate the highest density interval (HDI) for each parameter in the data.</p><p>For more details and a description of the <code>kwargs</code>, see <a href="@extref"><code>PosteriorStats.hdi</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/InferenceObjects.jl/blob/v0.4.12/ext/InferenceObjectsPosteriorStatsExt/hdi.jl#L8-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.hdi!" href="#PosteriorStats.hdi!"><code>PosteriorStats.hdi!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hdi!(samples::AbstractArray{&lt;:Real}; prob=0.94) -&gt; (; lower, upper)</code></pre><p>A version of <a href="#PosteriorStats.hdi"><code>hdi</code></a> that sorts <code>samples</code> in-place while computing the HDI.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/hdi.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.r2_score" href="#PosteriorStats.r2_score"><code>PosteriorStats.r2_score</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r2_score(y_true::AbstractVector, y_pred::AbstractArray) -&gt; (; r2, r2_std)</code></pre><p><span>$R²$</span> for linear Bayesian regression models.<sup class="footnote-reference"><a id="citeref-GelmanGoodrich2019" href="#footnote-GelmanGoodrich2019">[GelmanGoodrich2019]</a></sup></p><p><strong>Arguments</strong></p><ul><li><code>y_true</code>: Observed data of length <code>noutputs</code></li><li><code>y_pred</code>: Predicted data with size <code>(ndraws[, nchains], noutputs)</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; idata = load_example_data(&quot;regression1d&quot;);

julia&gt; y_true = idata.observed_data.y;

julia&gt; y_pred = PermutedDimsArray(idata.posterior_predictive.y, (:draw, :chain, :y_dim_0));

julia&gt; r2_score(y_true, y_pred) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :r2     =&gt; 0.683197
  :r2_std =&gt; 0.0368838</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/r2_score.jl#L1-L32">source</a></section><section><div><pre><code class="language-julia hljs">r2_score(idata::InferenceData; y_name, y_pred_name) -&gt; (; r2, r2_std)</code></pre><p>Compute <span>$R²$</span> from <code>idata</code>, automatically formatting the predictions to the correct shape.</p><p><strong>Keywords</strong></p><ul><li><code>y_name</code>: Name of observed data variable in <code>idata.observed_data</code>. If not provided, then the only observed data variable is used.</li><li><code>y_pred_name</code>: Name of posterior predictive variable in <code>idata.posterior_predictive</code>. If not provided, then <code>y_name</code> is used.</li></ul><p>See <a href="@extref"><code>PosteriorStats.r2_score</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData, PosteriorStats

julia&gt; idata = load_example_data(&quot;regression10d&quot;);

julia&gt; r2_score(idata) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :r2     =&gt; 0.998385
  :r2_std =&gt; 0.000100621</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/InferenceObjects.jl/blob/v0.4.12/ext/InferenceObjectsPosteriorStatsExt/r2_score.jl#L1-L27">source</a></section></article><h2 id="Pareto-smoothed-importance-sampling"><a class="docs-heading-anchor" href="#Pareto-smoothed-importance-sampling">Pareto-smoothed importance sampling</a><a id="Pareto-smoothed-importance-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Pareto-smoothed-importance-sampling" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PSIS.PSISResult" href="#PSIS.PSISResult"><code>PSIS.PSISResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PSISResult</code></pre><p>Result of Pareto-smoothed importance sampling (PSIS) using <a href="#PSIS.psis"><code>psis</code></a>.</p><p><strong>Properties</strong></p><ul><li><code>log_weights</code>: un-normalized Pareto-smoothed log weights</li><li><code>weights</code>: normalized Pareto-smoothed weights (allocates a copy)</li><li><code>pareto_shape</code>: Pareto <span>$k=ξ$</span> shape parameter</li><li><code>nparams</code>: number of parameters in <code>log_weights</code></li><li><code>ndraws</code>: number of draws in <code>log_weights</code></li><li><code>nchains</code>: number of chains in <code>log_weights</code></li><li><code>reff</code>: the ratio of the effective sample size of the unsmoothed importance ratios and the actual sample size.</li><li><code>ess</code>: estimated effective sample size of estimate of mean using smoothed importance samples (see <a href="#PSIS.ess_is"><code>ess_is</code></a>)</li><li><code>tail_length</code>: length of the upper tail of <code>log_weights</code> that was smoothed</li><li><code>tail_dist</code>: the generalized Pareto distribution that was fit to the tail of <code>log_weights</code>. Note that the tail weights are scaled to have a maximum of 1, so <code>tail_dist * exp(maximum(log_ratios))</code> is the corresponding fit directly to the tail of <code>log_ratios</code>.</li><li><code>normalized::Bool</code>:indicates whether <code>log_weights</code> are log-normalized along the sample dimensions.</li></ul><p><strong>Diagnostic</strong></p><p>The <code>pareto_shape</code> parameter <span>$k=ξ$</span> of the generalized Pareto distribution <code>tail_dist</code> can be used to diagnose reliability and convergence of estimates using the importance weights <a href="@citep">VehtariSimpson2021</a>.</p><ul><li>if <span>$k &lt; \frac{1}{3}$</span>, importance sampling is stable, and importance sampling (IS) and PSIS both are reliable.</li><li>if <span>$k ≤ \frac{1}{2}$</span>, then the importance ratio distributon has finite variance, and the central limit theorem holds. As <span>$k$</span> approaches the upper bound, IS becomes less reliable, while PSIS still works well but with a higher RMSE.</li><li>if <span>$\frac{1}{2} &lt; k ≤ 0.7$</span>, then the variance is infinite, and IS can behave quite poorly. However, PSIS works well in this regime.</li><li>if <span>$0.7 &lt; k ≤ 1$</span>, then it quickly becomes impractical to collect enough importance weights to reliably compute estimates, and importance sampling is not recommended.</li><li>if <span>$k &gt; 1$</span>, then neither the variance nor the mean of the raw importance ratios exists. The convergence rate is close to zero, and bias can be large with practical sample sizes.</li></ul><p>See <a href="#PSIS.PSISPlots.paretoshapeplot"><code>PSISPlots.paretoshapeplot</code></a> for a diagnostic plot.</p><p><strong>References</strong></p><ul><li><a href="@cite">VehtariSimpson2021</a> Vehtari et al. JMLR 25:72 (2021).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PSIS.jl/blob/v0.9.8/src/core.jl#L12-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PSIS.ess_is" href="#PSIS.ess_is"><code>PSIS.ess_is</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ess_is(weights; reff=1)</code></pre><p>Estimate effective sample size (ESS) for importance sampling over the sample dimensions.</p><p>Given normalized weights <span>$w_{1:n}$</span>, the ESS is estimated using the L2-norm of the weights:</p><p class="math-container">\[\mathrm{ESS}(w_{1:n}) = \frac{r_{\mathrm{eff}}}{\sum_{i=1}^n w_i^2}\]</p><p>where <span>$r_{\mathrm{eff}}$</span> is the relative efficiency of the <code>log_weights</code>.</p><pre><code class="nohighlight hljs">ess_is(result::PSISResult; bad_shape_nan=true)</code></pre><p>Estimate ESS for Pareto-smoothed importance sampling.</p><div class="admonition is-info" id="Note-16a910af22d7c3f4"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-16a910af22d7c3f4" title="Permalink"></a></header><div class="admonition-body"><p>ESS estimates for Pareto shape values <span>$k &gt; 0.7$</span>, which are unreliable and misleadingly high, are set to <code>NaN</code>. To avoid this, set <code>bad_shape_nan=false</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PSIS.jl/blob/v0.9.8/src/ess.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PSIS.PSISPlots.paretoshapeplot" href="#PSIS.PSISPlots.paretoshapeplot"><code>PSIS.PSISPlots.paretoshapeplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">paretoshapeplot(values; showlines=false, ...)
paretoshapeplot!(values; showlines=false, kwargs...)</code></pre><p>Plot shape parameters of fitted Pareto tail distributions for diagnosing convergence.</p><p><code>values</code> may be either a vector of Pareto shape parameters or a <a href="#PSIS.PSISResult"><code>PSIS.PSISResult</code></a>.</p><p>If <code>showlines==true</code>, horizontal lines indicating relevant Pareto shape thresholds are drawn. See <a href="#PSIS.PSISResult"><code>PSIS.PSISResult</code></a> for an explanation of the thresholds.</p><p>All remaining <code>kwargs</code> are forwarded to the plotting function.</p><p>See <a href="#PSIS.psis"><code>psis</code></a>, <a href="#PSIS.PSISResult"><code>PSISResult</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PSIS, Distributions, Plots
proposal = Normal()
target = TDist(7)
x = rand(proposal, 1_000, 100)
log_ratios = logpdf.(target, x) .- logpdf.(proposal, x)
result = psis(log_ratios)
paretoshapeplot(result)</code></pre><p>We can also plot the Pareto shape parameters directly:</p><pre><code class="language-julia hljs">paretoshapeplot(result.pareto_shape)</code></pre><p>We can also use <code>plot</code> directly:</p><pre><code class="language-julia hljs">plot(result.pareto_shape; showlines=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PSIS.jl/blob/v0.9.8/src/recipes/plots.jl#L11-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PSIS.psis" href="#PSIS.psis"><code>PSIS.psis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">psis(log_ratios, reff = 1.0; kwargs...) -&gt; PSISResult
psis!(log_ratios, reff = 1.0; kwargs...) -&gt; PSISResult</code></pre><p>Compute Pareto smoothed importance sampling (PSIS) log weights <a href="@citep">VehtariSimpson2021</a>.</p><p>While <code>psis</code> computes smoothed log weights out-of-place, <code>psis!</code> smooths them in-place.</p><p><strong>Arguments</strong></p><ul><li><code>log_ratios</code>: an array of logarithms of importance ratios, with size <code>(draws, [chains, [parameters...]])</code>, where <code>chains&gt;1</code> would be used when chains are generated using Markov chain Monte Carlo.</li><li><code>reff::Union{Real,AbstractArray}</code>: the ratio(s) of effective sample size of <code>log_ratios</code> and the actual sample size <code>reff = ess/(draws * chains)</code>, used to account for autocorrelation, e.g. due to Markov chain Monte Carlo. If an array, it must have the size <code>(parameters...,)</code> to match <code>log_ratios</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>warn=true</code>: If <code>true</code>, warning messages are delivered</li><li><code>normalize=true</code>: If <code>true</code>, the log-weights will be log-normalized so that <code>exp.(log_weights)</code> sums to 1 along the sample dimensions.</li></ul><p><strong>Returns</strong></p><ul><li><code>result</code>: a <a href="#PSIS.PSISResult"><code>PSISResult</code></a> object containing the results of the Pareto-smoothing.</li></ul><p>A warning is raised if the Pareto shape parameter <span>$k ≥ 0.7$</span>. See <a href="#PSIS.PSISResult"><code>PSISResult</code></a> for details and <a href="#PSIS.PSISPlots.paretoshapeplot"><code>PSISPlots.paretoshapeplot</code></a> for a diagnostic plot.</p><p><strong>Examples</strong></p><p>Here we smooth log importance ratios for importance sampling 30 isotropic Student <span>$t$</span>-distributed parameters using standard normal distributions as proposals.</p><pre><code class="language-julia-repl hljs">julia&gt; using Distributions

julia&gt; proposal, target = Normal(), TDist(7);

julia&gt; x = rand(proposal, 1_000, 1, 30);  # (ndraws, nchains, nparams)

julia&gt; log_ratios = @. logpdf(target, x) - logpdf(proposal, x);

julia&gt; result = psis(log_ratios)
┌ Warning: 9 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...
┌ Warning: 1 parameters had Pareto shape values k &gt; 1. Corresponding importance sampling estimates are likely to be unstable and are unlikely to converge with additional samples.
└ @ PSIS ~/.julia/packages/PSIS/...
PSISResult with 1000 draws, 1 chains, and 30 parameters
Pareto shape (k) diagnostic values:
                        Count       Min. ESS
 (-Inf, 0.5]  good       7 (23.3%)  959
  (0.5, 0.7]  okay      13 (43.3%)  938
    (0.7, 1]  bad        9 (30.0%)  ——
    (1, Inf)  very bad   1 (3.3%)   ——</code></pre><p>If the draws were generated using MCMC, we can compute the relative efficiency using <a href="@extref"><code>MCMCDiagnosticTools.ess</code></a>.</p><pre><code class="language-julia-repl hljs">julia&gt; using MCMCDiagnosticTools

julia&gt; reff = ess(log_ratios; kind=:basic, split_chains=1, relative=true);

julia&gt; result = psis(log_ratios, reff)
┌ Warning: 9 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...
┌ Warning: 1 parameters had Pareto shape values k &gt; 1. Corresponding importance sampling estimates are likely to be unstable and are unlikely to converge with additional samples.
└ @ PSIS ~/.julia/packages/PSIS/...
PSISResult with 1000 draws, 1 chains, and 30 parameters
Pareto shape (k) diagnostic values:
                        Count       Min. ESS
 (-Inf, 0.5]  good       9 (30.0%)  806
  (0.5, 0.7]  okay      11 (36.7%)  842
    (0.7, 1]  bad        9 (30.0%)  ——
    (1, Inf)  very bad   1 (3.3%)   ——</code></pre><p><strong>References</strong></p><ul><li><a href="@cite">VehtariSimpson2021</a> Vehtari et al. JMLR 25:72 (2021).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PSIS.jl/blob/v0.9.8/src/core.jl#L176-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PSIS.psis!" href="#PSIS.psis!"><code>PSIS.psis!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">psis(log_ratios, reff = 1.0; kwargs...) -&gt; PSISResult
psis!(log_ratios, reff = 1.0; kwargs...) -&gt; PSISResult</code></pre><p>Compute Pareto smoothed importance sampling (PSIS) log weights <a href="@citep">VehtariSimpson2021</a>.</p><p>While <code>psis</code> computes smoothed log weights out-of-place, <code>psis!</code> smooths them in-place.</p><p><strong>Arguments</strong></p><ul><li><code>log_ratios</code>: an array of logarithms of importance ratios, with size <code>(draws, [chains, [parameters...]])</code>, where <code>chains&gt;1</code> would be used when chains are generated using Markov chain Monte Carlo.</li><li><code>reff::Union{Real,AbstractArray}</code>: the ratio(s) of effective sample size of <code>log_ratios</code> and the actual sample size <code>reff = ess/(draws * chains)</code>, used to account for autocorrelation, e.g. due to Markov chain Monte Carlo. If an array, it must have the size <code>(parameters...,)</code> to match <code>log_ratios</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>warn=true</code>: If <code>true</code>, warning messages are delivered</li><li><code>normalize=true</code>: If <code>true</code>, the log-weights will be log-normalized so that <code>exp.(log_weights)</code> sums to 1 along the sample dimensions.</li></ul><p><strong>Returns</strong></p><ul><li><code>result</code>: a <a href="#PSIS.PSISResult"><code>PSISResult</code></a> object containing the results of the Pareto-smoothing.</li></ul><p>A warning is raised if the Pareto shape parameter <span>$k ≥ 0.7$</span>. See <a href="#PSIS.PSISResult"><code>PSISResult</code></a> for details and <a href="#PSIS.PSISPlots.paretoshapeplot"><code>PSISPlots.paretoshapeplot</code></a> for a diagnostic plot.</p><p><strong>Examples</strong></p><p>Here we smooth log importance ratios for importance sampling 30 isotropic Student <span>$t$</span>-distributed parameters using standard normal distributions as proposals.</p><pre><code class="language-julia-repl hljs">julia&gt; using Distributions

julia&gt; proposal, target = Normal(), TDist(7);

julia&gt; x = rand(proposal, 1_000, 1, 30);  # (ndraws, nchains, nparams)

julia&gt; log_ratios = @. logpdf(target, x) - logpdf(proposal, x);

julia&gt; result = psis(log_ratios)
┌ Warning: 9 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...
┌ Warning: 1 parameters had Pareto shape values k &gt; 1. Corresponding importance sampling estimates are likely to be unstable and are unlikely to converge with additional samples.
└ @ PSIS ~/.julia/packages/PSIS/...
PSISResult with 1000 draws, 1 chains, and 30 parameters
Pareto shape (k) diagnostic values:
                        Count       Min. ESS
 (-Inf, 0.5]  good       7 (23.3%)  959
  (0.5, 0.7]  okay      13 (43.3%)  938
    (0.7, 1]  bad        9 (30.0%)  ——
    (1, Inf)  very bad   1 (3.3%)   ——</code></pre><p>If the draws were generated using MCMC, we can compute the relative efficiency using <a href="@extref"><code>MCMCDiagnosticTools.ess</code></a>.</p><pre><code class="language-julia-repl hljs">julia&gt; using MCMCDiagnosticTools

julia&gt; reff = ess(log_ratios; kind=:basic, split_chains=1, relative=true);

julia&gt; result = psis(log_ratios, reff)
┌ Warning: 9 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...
┌ Warning: 1 parameters had Pareto shape values k &gt; 1. Corresponding importance sampling estimates are likely to be unstable and are unlikely to converge with additional samples.
└ @ PSIS ~/.julia/packages/PSIS/...
PSISResult with 1000 draws, 1 chains, and 30 parameters
Pareto shape (k) diagnostic values:
                        Count       Min. ESS
 (-Inf, 0.5]  good       9 (30.0%)  806
  (0.5, 0.7]  okay      11 (36.7%)  842
    (0.7, 1]  bad        9 (30.0%)  ——
    (1, Inf)  very bad   1 (3.3%)   ——</code></pre><p><strong>References</strong></p><ul><li><a href="@cite">VehtariSimpson2021</a> Vehtari et al. JMLR 25:72 (2021).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PSIS.jl/blob/v0.9.8/src/core.jl#L176-L260">source</a></section></article><h2 id="LOO-and-WAIC"><a class="docs-heading-anchor" href="#LOO-and-WAIC">LOO and WAIC</a><a id="LOO-and-WAIC-1"></a><a class="docs-heading-anchor-permalink" href="#LOO-and-WAIC" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.AbstractELPDResult" href="#PosteriorStats.AbstractELPDResult"><code>PosteriorStats.AbstractELPDResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractELPDResult</code></pre><p>An abstract type representing the result of an ELPD computation.</p><p>Every subtype stores estimates of both the expected log predictive density (<code>elpd</code>) and the effective number of parameters <code>p</code>, as well as standard errors and pointwise estimates of each, from which other relevant estimates can be computed.</p><p>Subtypes implement the following functions:</p><ul><li><a href="#PosteriorStats.elpd_estimates"><code>elpd_estimates</code></a></li><li><a href="#PosteriorStats.information_criterion"><code>information_criterion</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/elpdresult.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.PSISLOOResult" href="#PosteriorStats.PSISLOOResult"><code>PosteriorStats.PSISLOOResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Results of Pareto-smoothed importance sampling leave-one-out cross-validation (PSIS-LOO).</p><p>See also: <a href="#PosteriorStats.loo"><code>loo</code></a>, <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a></p><ul><li><p><code>estimates</code>: Estimates of the expected log pointwise predictive density (ELPD) and effective number of parameters (p)</p></li><li><p><code>pointwise</code>: Pointwise estimates</p></li><li><p><code>psis_result</code>: Pareto-smoothed importance sampling (PSIS) results</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/loo.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.WAICResult" href="#PosteriorStats.WAICResult"><code>PosteriorStats.WAICResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Results of computing the widely applicable information criterion (WAIC).</p><p>See also: <a href="#PosteriorStats.waic"><code>waic</code></a>, <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a></p><ul><li><p><code>estimates</code>: Estimates of the expected log pointwise predictive density (ELPD) and effective number of parameters (p)</p></li><li><p><code>pointwise</code>: Pointwise estimates</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/waic.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.elpd_estimates" href="#PosteriorStats.elpd_estimates"><code>PosteriorStats.elpd_estimates</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">elpd_estimates(result::AbstractELPDResult; pointwise=false) -&gt; (; elpd, elpd_mcse, lpd)</code></pre><p>Return the (E)LPD estimates from the <code>result</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/elpdresult.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.information_criterion" href="#PosteriorStats.information_criterion"><code>PosteriorStats.information_criterion</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">information_criterion(elpd, scale::Symbol)</code></pre><p>Compute the information criterion for the given <code>scale</code> from the <code>elpd</code> estimate.</p><p><code>scale</code> must be one of <code>(:deviance, :log, :negative_log)</code>.</p><p>See also: <a href="#PosteriorStats.loo"><code>loo</code></a>, <a href="#PosteriorStats.waic"><code>waic</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/elpdresult.jl#L32-L40">source</a></section><section><div><pre><code class="language-julia hljs">information_criterion(result::AbstractELPDResult, scale::Symbol; pointwise=false)</code></pre><p>Compute information criterion for the given <code>scale</code> from the existing ELPD <code>result</code>.</p><p><code>scale</code> must be one of <code>(:deviance, :log, :negative_log)</code>.</p><p>If <code>pointwise=true</code>, then pointwise estimates are returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/elpdresult.jl#L46-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.loo" href="#PosteriorStats.loo"><code>PosteriorStats.loo</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loo(log_likelihood; reff=nothing, kwargs...) -&gt; PSISLOOResult{&lt;:NamedTuple,&lt;:NamedTuple}</code></pre><p>Compute the Pareto-smoothed importance sampling leave-one-out cross-validation (PSIS-LOO). <sup class="footnote-reference"><a id="citeref-Vehtari2017" href="#footnote-Vehtari2017">[Vehtari2017]</a></sup><sup class="footnote-reference"><a id="citeref-LOOFAQ" href="#footnote-LOOFAQ">[LOOFAQ]</a></sup></p><p><code>log_likelihood</code> must be an array of log-likelihood values with shape <code>(chains, draws[, params...])</code>.</p><p><strong>Keywords</strong></p><ul><li><code>reff::Union{Real,AbstractArray{&lt;:Real}}</code>: The relative effective sample size(s) of the <em>likelihood</em> values. If an array, it must have the same data dimensions as the corresponding log-likelihood variable. If not provided, then this is estimated using <code>MCMCDiagnosticTools.ess</code>.</li><li><code>kwargs</code>: Remaining keywords are forwarded to [<code>PSIS.psis</code>].</li></ul><p>See also: <a href="#PosteriorStats.PSISLOOResult"><code>PSISLOOResult</code></a>, <a href="#PosteriorStats.waic"><code>waic</code></a></p><p><strong>Examples</strong></p><p>Manually compute <span>$R_\mathrm{eff}$</span> and calculate PSIS-LOO of a model:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData, MCMCDiagnosticTools

julia&gt; idata = load_example_data(&quot;centered_eight&quot;);

julia&gt; log_like = PermutedDimsArray(idata.log_likelihood.obs, (:draw, :chain, :school));

julia&gt; reff = ess(log_like; kind=:basic, split_chains=1, relative=true);

julia&gt; loo(log_like; reff)
PSISLOOResult with estimates
 elpd  elpd_mcse    p  p_mcse
  -31        1.4  0.9    0.33

and PSISResult with 500 draws, 4 chains, and 8 parameters
Pareto shape (k) diagnostic values:
                    Count      Min. ESS
 (-Inf, 0.5]  good  5 (62.5%)  290
  (0.5, 0.7]  okay  3 (37.5%)  399</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/loo.jl#L32-L82">source</a></section><section><div><pre><code class="language-julia hljs">loo(data::Dataset; [var_name::Symbol,] kwargs...) -&gt; PSISLOOResult{&lt;:NamedTuple,&lt;:Dataset}
loo(data::InferenceData; [var_name::Symbol,] kwargs...) -&gt; PSISLOOResult{&lt;:NamedTuple,&lt;:Dataset}</code></pre><p>Compute PSIS-LOO from log-likelihood values in <code>data</code>.</p><p>If more than one log-likelihood variable is present, then <code>var_name</code> must be provided.</p><p>For more details and a description of the <code>kwargs</code>, see <a href="@extref"><code>PosteriorStats.loo</code></a>.</p><p><strong>Examples</strong></p><p>Calculate PSIS-LOO of a model:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData, PosteriorStats

julia&gt; idata = load_example_data(&quot;centered_eight&quot;);

julia&gt; loo(idata)
PSISLOOResult with estimates
 elpd  elpd_mcse    p  p_mcse
  -31        1.4  0.9    0.33

and PSISResult with 500 draws, 4 chains, and 8 parameters
Pareto shape (k) diagnostic values:
                    Count      Min. ESS
 (-Inf, 0.5]  good  4 (50.0%)  270
  (0.5, 0.7]  okay  4 (50.0%)  307</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/InferenceObjects.jl/blob/v0.4.12/ext/InferenceObjectsPosteriorStatsExt/loo.jl#L1-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.waic" href="#PosteriorStats.waic"><code>PosteriorStats.waic</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waic(log_likelihood::AbstractArray) -&gt; WAICResult{&lt;:NamedTuple,&lt;:NamedTuple}</code></pre><p>Compute the widely applicable information criterion (WAIC).<sup class="footnote-reference"><a id="citeref-Watanabe2010" href="#footnote-Watanabe2010">[Watanabe2010]</a></sup><sup class="footnote-reference"><a id="citeref-Vehtari2017" href="#footnote-Vehtari2017">[Vehtari2017]</a></sup><sup class="footnote-reference"><a id="citeref-LOOFAQ" href="#footnote-LOOFAQ">[LOOFAQ]</a></sup></p><p><code>log_likelihood</code> must be an array of log-likelihood values with shape <code>(chains, draws[, params...])</code>.</p><p>See also: <a href="#PosteriorStats.WAICResult"><code>WAICResult</code></a>, <a href="#PosteriorStats.loo"><code>loo</code></a></p><p><strong>Examples</strong></p><p>Calculate WAIC of a model:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; idata = load_example_data(&quot;centered_eight&quot;);

julia&gt; log_like = PermutedDimsArray(idata.log_likelihood.obs, (:draw, :chain, :school));

julia&gt; waic(log_like)
WAICResult with estimates
 elpd  elpd_mcse    p  p_mcse
  -31        1.4  0.9    0.32</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/waic.jl#L26-L60">source</a></section><section><div><pre><code class="language-julia hljs">waic(data::Dataset; [var_name::Symbol]) -&gt; WAICResult{&lt;:NamedTuple,&lt;:Dataset}
waic(data::InferenceData; [var_name::Symbol]) -&gt; WAICResult{&lt;:NamedTuple,&lt;:Dataset}</code></pre><p>Compute WAIC from log-likelihood values in <code>data</code>.</p><p>If more than one log-likelihood variable is present, then <code>var_name</code> must be provided.</p><p>See <a href="@extref"><code>PosteriorStats.waic</code></a> for more details.</p><p><strong>Examples</strong></p><p>Calculate WAIC of a model:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData, PosteriorStats

julia&gt; idata = load_example_data(&quot;centered_eight&quot;);

julia&gt; waic(idata)
WAICResult with estimates
 elpd  elpd_mcse    p  p_mcse
  -31        1.4  0.9    0.32</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/InferenceObjects.jl/blob/v0.4.12/ext/InferenceObjectsPosteriorStatsExt/waic.jl#L1-L25">source</a></section></article><h2 id="Model-comparison"><a class="docs-heading-anchor" href="#Model-comparison">Model comparison</a><a id="Model-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-comparison" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.ModelComparisonResult" href="#PosteriorStats.ModelComparisonResult"><code>PosteriorStats.ModelComparisonResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModelComparisonResult</code></pre><p>Result of model comparison using ELPD.</p><p>This struct implements the Tables and TableTraits interfaces.</p><p>Each field returns a collection of the corresponding entry for each model:</p><ul><li><p><code>name</code>: Names of the models, if provided.</p></li><li><p><code>rank</code>: Ranks of the models (ordered by decreasing ELPD)</p></li><li><p><code>elpd_diff</code>: ELPD of a model subtracted from the largest ELPD of any model</p></li><li><p><code>elpd_diff_mcse</code>: Monte Carlo standard error of the ELPD difference</p></li><li><p><code>weight</code>: Model weights computed with <code>weights_method</code></p></li><li><p><code>elpd_result</code>: <code>AbstactELPDResult</code>s for each model, which can be used to access useful stats like ELPD estimates, pointwise estimates, and Pareto shape values for PSIS-LOO</p></li><li><p><code>weights_method</code>: Method used to compute model weights with <a href="#PosteriorStats.model_weights"><code>model_weights</code></a></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/compare.jl#L118-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.compare" href="#PosteriorStats.compare"><code>PosteriorStats.compare</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compare(models; kwargs...) -&gt; ModelComparisonResult</code></pre><p>Compare models based on their expected log pointwise predictive density (ELPD).</p><p>The ELPD is estimated either by Pareto smoothed importance sampling leave-one-out cross-validation (LOO) or using the widely applicable information criterion (WAIC). We recommend loo. Read more theory here - in a paper by some of the leading authorities on model comparison dx.doi.org/10.1111/1467-9868.00353</p><p><strong>Arguments</strong></p><ul><li><code>models</code>: a <code>Tuple</code>, <code>NamedTuple</code>, or <code>AbstractVector</code> whose values are either <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a> entries or any argument to <code>elpd_method</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>weights_method::AbstractModelWeightsMethod=Stacking()</code>: the method to be used to weight the models. See <a href="#PosteriorStats.model_weights"><code>model_weights</code></a> for details</li><li><code>elpd_method=loo</code>: a method that computes an <code>AbstractELPDResult</code> from an argument in <code>models</code>.</li><li><code>sort::Bool=true</code>: Whether to sort models by decreasing ELPD.</li></ul><p><strong>Returns</strong></p><ul><li><a href="#PosteriorStats.ModelComparisonResult"><code>ModelComparisonResult</code></a>: A container for the model comparison results. The fields contain a similar collection to <code>models</code>.</li></ul><p><strong>Examples</strong></p><p>Compare the centered and non centered models of the eight school problem using the defaults: <a href="#PosteriorStats.loo"><code>loo</code></a> and <a href="#PosteriorStats.Stacking"><code>Stacking</code></a> weights. A custom <code>myloo</code> method formates the inputs as expected by <a href="#PosteriorStats.loo"><code>loo</code></a>.</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; models = (
           centered=load_example_data(&quot;centered_eight&quot;),
           non_centered=load_example_data(&quot;non_centered_eight&quot;),
       );

julia&gt; function myloo(idata)
           log_like = PermutedDimsArray(idata.log_likelihood.obs, (2, 3, 1))
           return loo(log_like)
       end;

julia&gt; mc = compare(models; elpd_method=myloo)
┌ Warning: 1 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...
ModelComparisonResult with Stacking weights
               rank  elpd  elpd_mcse  elpd_diff  elpd_diff_mcse  weight    p   ⋯
 non_centered     1   -31        1.5       0              0.0       1.0  0.9   ⋯
 centered         2   -31        1.4       0.03           0.061     0.0  0.9   ⋯
                                                                1 column omitted
julia&gt; mc.weight |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :non_centered =&gt; 1.0
  :centered     =&gt; 3.50538e-31</code></pre><p>Compare the same models from pre-computed PSIS-LOO results and computing <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a> weights:</p><pre><code class="language-julia-repl hljs">julia&gt; elpd_results = mc.elpd_result;

julia&gt; compare(elpd_results; weights_method=BootstrappedPseudoBMA())
ModelComparisonResult with BootstrappedPseudoBMA weights
               rank  elpd  elpd_mcse  elpd_diff  elpd_diff_mcse  weight    p   ⋯
 non_centered     1   -31        1.5       0              0.0      0.51  0.9   ⋯
 centered         2   -31        1.4       0.03           0.061    0.49  0.9   ⋯
                                                                1 column omitted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/compare.jl#L1-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.model_weights" href="#PosteriorStats.model_weights"><code>PosteriorStats.model_weights</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">model_weights(elpd_results; method=Stacking())
model_weights(method::AbstractModelWeightsMethod, elpd_results)</code></pre><p>Compute weights for each model in <code>elpd_results</code> using <code>method</code>.</p><p><code>elpd_results</code> is a <code>Tuple</code>, <code>NamedTuple</code>, or <code>AbstractVector</code> with <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a> entries. The weights are returned in the same type of collection.</p><p><a href="#PosteriorStats.Stacking"><code>Stacking</code></a> is the recommended approach, as it performs well even when the true data generating process is not included among the candidate models. See <sup class="footnote-reference"><a id="citeref-YaoVehtari2018" href="#footnote-YaoVehtari2018">[YaoVehtari2018]</a></sup> for details.</p><p>See also: <a href="#PosteriorStats.AbstractModelWeightsMethod"><code>AbstractModelWeightsMethod</code></a>, <a href="#PosteriorStats.compare"><code>compare</code></a></p><p><strong>Examples</strong></p><p>Compute <a href="#PosteriorStats.Stacking"><code>Stacking</code></a> weights for two models:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; models = (
           centered=load_example_data(&quot;centered_eight&quot;),
           non_centered=load_example_data(&quot;non_centered_eight&quot;),
       );

julia&gt; elpd_results = map(models) do idata
           log_like = PermutedDimsArray(idata.log_likelihood.obs, (2, 3, 1))
           return loo(log_like)
       end;
┌ Warning: 1 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...

julia&gt; model_weights(elpd_results; method=Stacking()) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :centered     =&gt; 3.50546e-31
  :non_centered =&gt; 1.0</code></pre><p>Now we compute <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a> weights for the same models:</p><pre><code class="language-julia-repl hljs">julia&gt; model_weights(elpd_results; method=BootstrappedPseudoBMA()) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :centered     =&gt; 0.492513
  :non_centered =&gt; 0.507487</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/model_weights.jl#L12-L67">source</a></section></article><p>The following model weighting methods are available</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.AbstractModelWeightsMethod" href="#PosteriorStats.AbstractModelWeightsMethod"><code>PosteriorStats.AbstractModelWeightsMethod</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractModelWeightsMethod</code></pre><p>An abstract type representing methods for computing model weights.</p><p>Subtypes implement <a href="#PosteriorStats.model_weights"><code>model_weights</code></a><code>(method, elpd_results)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/model_weights.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.BootstrappedPseudoBMA" href="#PosteriorStats.BootstrappedPseudoBMA"><code>PosteriorStats.BootstrappedPseudoBMA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BootstrappedPseudoBMA{R&lt;:Random.AbstractRNG, T&lt;:Real} &lt;: AbstractModelWeightsMethod</code></pre><p>Model weighting method using pseudo Bayesian Model Averaging using Akaike-type weighting with the Bayesian bootstrap (pseudo-BMA+)<sup class="footnote-reference"><a id="citeref-YaoVehtari2018" href="#footnote-YaoVehtari2018">[YaoVehtari2018]</a></sup>.</p><p>The Bayesian bootstrap stabilizes the model weights.</p><pre><code class="nohighlight hljs">BootstrappedPseudoBMA(; rng=Random.default_rng(), samples=1_000, alpha=1)
BootstrappedPseudoBMA(rng, samples, alpha)</code></pre><p>Construct the method.</p><ul><li><p><code>rng::Random.AbstractRNG</code>: The random number generator to use for the Bayesian bootstrap</p></li><li><p><code>samples::Int64</code>: The number of samples to draw for bootstrapping</p></li><li><p><code>alpha::Real</code>: The shape parameter in the Dirichlet distribution used for the Bayesian bootstrap. The default (1) corresponds to a uniform distribution on the simplex.</p></li></ul><p>See also: <a href="#PosteriorStats.Stacking"><code>Stacking</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/model_weights.jl#L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.PseudoBMA" href="#PosteriorStats.PseudoBMA"><code>PosteriorStats.PseudoBMA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct PseudoBMA &lt;: AbstractModelWeightsMethod</code></pre><p>Model weighting method using pseudo Bayesian Model Averaging (pseudo-BMA) and Akaike-type weighting.</p><pre><code class="nohighlight hljs">PseudoBMA(; regularize=false)
PseudoBMA(regularize)</code></pre><p>Construct the method with optional regularization of the weights using the standard error of the ELPD estimate.</p><div class="admonition is-info" id="Note-32b56731320fe6d1"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-32b56731320fe6d1" title="Permalink"></a></header><div class="admonition-body"><p>This approach is not recommended, as it produces unstable weight estimates. It is recommended to instead use <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a> to stabilize the weights or <a href="#PosteriorStats.Stacking"><code>Stacking</code></a>. For details, see <sup class="footnote-reference"><a id="citeref-YaoVehtari2018" href="#footnote-YaoVehtari2018">[YaoVehtari2018]</a></sup>.</p></div></div><p>See also: <a href="#PosteriorStats.Stacking"><code>Stacking</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/model_weights.jl#L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.Stacking" href="#PosteriorStats.Stacking"><code>PosteriorStats.Stacking</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Stacking{O&lt;:Optim.AbstractOptimizer} &lt;: AbstractModelWeightsMethod</code></pre><p>Model weighting using stacking of predictive distributions<sup class="footnote-reference"><a id="citeref-YaoVehtari2018" href="#footnote-YaoVehtari2018">[YaoVehtari2018]</a></sup>.</p><pre><code class="nohighlight hljs">Stacking(; optimizer=Optim.LBFGS(), options=Optim.Options()
Stacking(optimizer[, options])</code></pre><p>Construct the method, optionally customizing the optimization.</p><ul><li><p><code>optimizer::Optim.AbstractOptimizer</code>: The optimizer to use for the optimization of the weights. The optimizer must support projected gradient optimization via a <code>manifold</code> field.</p></li><li><p><code>options::Optim.Options</code>: The Optim options to use for the optimization of the weights.</p></li></ul><p>See also: <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/model_weights.jl#L181">source</a></section></article><h2 id="Predictive-checks"><a class="docs-heading-anchor" href="#Predictive-checks">Predictive checks</a><a id="Predictive-checks-1"></a><a class="docs-heading-anchor-permalink" href="#Predictive-checks" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.loo_pit" href="#PosteriorStats.loo_pit"><code>PosteriorStats.loo_pit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loo_pit(y, y_pred, log_weights; kwargs...) -&gt; Union{Real,AbstractArray}</code></pre><p>Compute leave-one-out probability integral transform (LOO-PIT) checks.</p><p><strong>Arguments</strong></p><ul><li><code>y</code>: array of observations with shape <code>(params...,)</code></li><li><code>y_pred</code>: array of posterior predictive samples with shape <code>(draws, chains, params...)</code>.</li><li><code>log_weights</code>: array of normalized log LOO importance weights with shape <code>(draws, chains, params...)</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>is_discrete</code>: If not provided, then it is set to <code>true</code> iff elements of <code>y</code> and <code>y_pred</code> are all integer-valued. If <code>true</code>, then data are smoothed using <a href="#PosteriorStats.smooth_data"><code>smooth_data</code></a> to make them non-discrete before estimating LOO-PIT values.</li><li><code>kwargs</code>: Remaining keywords are forwarded to <code>smooth_data</code> if data is discrete.</li></ul><p><strong>Returns</strong></p><ul><li><code>pitvals</code>: LOO-PIT values with same size as <code>y</code>. If <code>y</code> is a scalar, then <code>pitvals</code> is a scalar.</li></ul><p>LOO-PIT is a marginal posterior predictive check. If <span>$y_{-i}$</span> is the array <span>$y$</span> of observations with the <span>$i$</span>th observation left out, and <span>$y_i^*$</span> is a posterior prediction of the <span>$i$</span>th observation, then the LOO-PIT value for the <span>$i$</span>th observation is defined as</p><p class="math-container">\[P(y_i^* \le y_i \mid y_{-i}) = \int_{-\infty}^{y_i} p(y_i^* \mid y_{-i}) \mathrm{d} y_i^*\]</p><p>The LOO posterior predictions and the corresponding observations should have similar distributions, so if conditional predictive distributions are well-calibrated, then all LOO-PIT values should be approximately uniformly distributed on <span>$[0, 1]$</span>.<sup class="footnote-reference"><a id="citeref-Gabry2019" href="#footnote-Gabry2019">[Gabry2019]</a></sup></p><p><strong>Examples</strong></p><p>Calculate LOO-PIT values using as test quantity the observed values themselves.</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; idata = load_example_data(&quot;centered_eight&quot;);

julia&gt; y = idata.observed_data.obs;

julia&gt; y_pred = PermutedDimsArray(idata.posterior_predictive.obs, (:draw, :chain, :school));

julia&gt; log_like = PermutedDimsArray(idata.log_likelihood.obs, (:draw, :chain, :school));

julia&gt; log_weights = loo(log_like).psis_result.log_weights;

julia&gt; loo_pit(y, y_pred, log_weights)
┌ 8-element DimArray{Float64, 1} ┐
├────────────────────────────────┴─────────────────────────────── dims ┐
  ↓ school Categorical{String} [&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;] Unordered
└──────────────────────────────────────────────────────────────────────┘
 &quot;Choate&quot;            0.942759
 &quot;Deerfield&quot;         0.641057
 &quot;Phillips Andover&quot;  0.32729
 &quot;Phillips Exeter&quot;   0.581451
 &quot;Hotchkiss&quot;         0.288523
 &quot;Lawrenceville&quot;     0.393741
 &quot;St. Paul&#39;s&quot;        0.886175
 &quot;Mt. Hermon&quot;        0.638821</code></pre><p>Calculate LOO-PIT values using as test quantity the square of the difference between each observation and <code>mu</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; using Statistics

julia&gt; mu = idata.posterior.mu;

julia&gt; T = y .- median(mu);

julia&gt; T_pred = y_pred .- mu;

julia&gt; loo_pit(T .^ 2, T_pred .^ 2, log_weights)
┌ 8-element DimArray{Float64, 1} ┐
├────────────────────────────────┴─────────────────────────────── dims ┐
  ↓ school Categorical{String} [&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;] Unordered
└──────────────────────────────────────────────────────────────────────┘
 &quot;Choate&quot;            0.868148
 &quot;Deerfield&quot;         0.27421
 &quot;Phillips Andover&quot;  0.321719
 &quot;Phillips Exeter&quot;   0.193169
 &quot;Hotchkiss&quot;         0.370422
 &quot;Lawrenceville&quot;     0.195601
 &quot;St. Paul&#39;s&quot;        0.817408
 &quot;Mt. Hermon&quot;        0.326795</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/loo_pit.jl#L1-L101">source</a></section><section><div><pre><code class="language-julia hljs">loo_pit(idata::InferenceData, log_weights; kwargs...) -&gt; DimArray</code></pre><p>Compute LOO-PIT values using existing normalized log LOO importance weights.</p><p><strong>Keywords</strong></p><ul><li><code>y_name</code>: Name of observed data variable in <code>idata.observed_data</code>. If not provided, then the only observed data variable is used.</li><li><code>y_pred_name</code>: Name of posterior predictive variable in <code>idata.posterior_predictive</code>. If not provided, then <code>y_name</code> is used.</li><li><code>kwargs</code>: Remaining keywords are forwarded to the base method <a href="@extref"><code>PosteriorStats.loo_pit</code></a>.</li></ul><p>See <a href="@extref"><code>PosteriorStats.loo_pit</code></a> for more details.</p><p><strong>Examples</strong></p><p>Calculate LOO-PIT values using already computed log weights.</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData, PosteriorStats

julia&gt; idata = load_example_data(&quot;centered_eight&quot;);

julia&gt; loo_result = loo(idata; var_name=:obs);

julia&gt; loo_pit(idata, loo_result.psis_result.log_weights; y_name=:obs)
┌ 8-element DimArray{Float64, 1} loo_pit_obs ┐
├────────────────────────────────────────────┴─────────────────── dims ┐
  ↓ school Categorical{String} [&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;] Unordered
└──────────────────────────────────────────────────────────────────────┘
 &quot;Choate&quot;            0.942759
 &quot;Deerfield&quot;         0.641057
 &quot;Phillips Andover&quot;  0.32729
 &quot;Phillips Exeter&quot;   0.581451
 &quot;Hotchkiss&quot;         0.288523
 &quot;Lawrenceville&quot;     0.393741
 &quot;St. Paul&#39;s&quot;        0.886175
 &quot;Mt. Hermon&quot;        0.638821</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/InferenceObjects.jl/blob/v0.4.12/ext/InferenceObjectsPosteriorStatsExt/loo_pit.jl#L1-L42">source</a></section><section><div><pre><code class="language-julia hljs">loo_pit(idata::InferenceData; kwargs...) -&gt; DimArray</code></pre><p>Compute LOO-PIT from groups in <code>idata</code> using PSIS-LOO.</p><p><strong>Keywords</strong></p><ul><li><code>y_name</code>: Name of observed data variable in <code>idata.observed_data</code>. If not provided, then the only observed data variable is used.</li><li><code>y_pred_name</code>: Name of posterior predictive variable in <code>idata.posterior_predictive</code>. If not provided, then <code>y_name</code> is used.</li><li><code>log_likelihood_name</code>: Name of log-likelihood variable in <code>idata.log_likelihood</code>. If not provided, then <code>y_name</code> is used if <code>idata</code> has a <code>log_likelihood</code> group, otherwise the only variable is used.</li><li><code>reff::Union{Real,AbstractArray{&lt;:Real}}</code>: The relative effective sample size(s) of the <em>likelihood</em> values. If an array, it must have the same data dimensions as the corresponding log-likelihood variable. If not provided, then this is estimated using <code>ess</code>.</li><li><code>kwargs</code>: Remaining keywords are forwarded to <a href="@extref"><code>PosteriorStats.loo_pit</code></a>.</li></ul><p>See <a href="@extref"><code>PosteriorStats.loo_pit</code></a> for more details.</p><p><strong>Examples</strong></p><p>Calculate LOO-PIT values using as test quantity the observed values themselves.</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData, PosteriorStats

julia&gt; idata = load_example_data(&quot;centered_eight&quot;);

julia&gt; loo_pit(idata; y_name=:obs)
┌ 8-element DimArray{Float64, 1} loo_pit_obs ┐
├────────────────────────────────────────────┴─────────────────── dims ┐
  ↓ school Categorical{String} [&quot;Choate&quot;, …, &quot;Mt. Hermon&quot;] Unordered
└──────────────────────────────────────────────────────────────────────┘
 &quot;Choate&quot;            0.942759
 &quot;Deerfield&quot;         0.641057
 &quot;Phillips Andover&quot;  0.32729
 &quot;Phillips Exeter&quot;   0.581451
 &quot;Hotchkiss&quot;         0.288523
 &quot;Lawrenceville&quot;     0.393741
 &quot;St. Paul&#39;s&quot;        0.886175
 &quot;Mt. Hermon&quot;        0.638821</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/InferenceObjects.jl/blob/v0.4.12/ext/InferenceObjectsPosteriorStatsExt/loo_pit.jl#L56-L101">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosteriorStats.smooth_data" href="#PosteriorStats.smooth_data"><code>PosteriorStats.smooth_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">smooth_data(y; dims=:, interp_method=CubicSpline, offset_frac=0.01)</code></pre><p>Smooth <code>y</code> along <code>dims</code> using <code>interp_method</code>.</p><p><code>interp_method</code> is a 2-argument callabale that takes the arguments <code>y</code> and <code>x</code> and returns a DataInterpolations.jl interpolation method, defaulting to a cubic spline interpolator.</p><p><code>offset_frac</code> is the fraction of the length of <code>y</code> to use as an offset when interpolating.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/v0.2.8/src/utils.jl#L8-L17">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Hyndman1996"><a class="tag is-link" href="#citeref-Hyndman1996">Hyndman1996</a>Rob J. Hyndman (1996) Computing and Graphing Highest Density Regions,             Amer. Stat., 50(2): 120-6.             DOI: <a href="https://doi.org/10.1080/00031305.1996.10474359">10.1080/00031305.1996.10474359</a>             <a href="https://doi.org/10.2307/2684423">jstor</a>.</li><li class="footnote" id="footnote-ChenShao1999"><a class="tag is-link" href="#citeref-ChenShao1999">ChenShao1999</a>Ming-Hui Chen &amp; Qi-Man Shao (1999)              Monte Carlo Estimation of Bayesian Credible and HPD Intervals,              J Comput. Graph. Stat., 8:1, 69-92.              DOI: <a href="https://doi.org/10.1080/00031305.1996.10474359">10.1080/10618600.1999.10474802</a>              <a href="https://doi.org/10.2307/1390921">jstor</a>.</li><li class="footnote" id="footnote-GelmanGoodrich2019"><a class="tag is-link" href="#citeref-GelmanGoodrich2019">GelmanGoodrich2019</a>Andrew Gelman, Ben Goodrich, Jonah Gabry &amp; Aki Vehtari (2019) R-squared for Bayesian Regression Models, The American Statistician, 73:3, 307-9, DOI: <a href="https://doi.org/10.1080/00031305.2018.1549100">10.1080/00031305.2018.1549100</a>.</li><li class="footnote" id="footnote-Vehtari2017"><a class="tag is-link" href="#citeref-Vehtari2017">Vehtari2017</a>Vehtari, A., Gelman, A. &amp; Gabry, J. Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Stat Comput 27, 1413–1432 (2017). doi: <a href="https://doi.org/10.1007/s11222-016-9696-4">10.1007/s11222-016-9696-4</a> arXiv: <a href="https://arxiv.org/abs/1507.04544">1507.04544</a></li><li class="footnote" id="footnote-LOOFAQ"><a class="tag is-link" href="#citeref-LOOFAQ">LOOFAQ</a>Aki Vehtari. Cross-validation FAQ. https://mc-stan.org/loo/articles/online-only/faq.html</li><li class="footnote" id="footnote-Watanabe2010"><a class="tag is-link" href="#citeref-Watanabe2010">Watanabe2010</a>Watanabe, S. Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable Information Criterion in Singular Learning Theory. 11(116):3571−3594, 2010. https://jmlr.csail.mit.edu/papers/v11/watanabe10a.html</li><li class="footnote" id="footnote-Vehtari2017"><a class="tag is-link" href="#citeref-Vehtari2017">Vehtari2017</a>Vehtari, A., Gelman, A. &amp; Gabry, J. Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Stat Comput 27, 1413–1432 (2017). doi: <a href="https://doi.org/10.1007/s11222-016-9696-4">10.1007/s11222-016-9696-4</a> arXiv: <a href="https://arxiv.org/abs/1507.04544">1507.04544</a></li><li class="footnote" id="footnote-LOOFAQ"><a class="tag is-link" href="#citeref-LOOFAQ">LOOFAQ</a>Aki Vehtari. Cross-validation FAQ. https://mc-stan.org/loo/articles/online-only/faq.html</li><li class="footnote" id="footnote-YaoVehtari2018"><a class="tag is-link" href="#citeref-YaoVehtari2018">YaoVehtari2018</a>Yuling Yao, Aki Vehtari, Daniel Simpson, and Andrew Gelman.                Using Stacking to Average Bayesian Predictive Distributions.                2018. Bayesian Analysis. 13, 3, 917–1007.                doi: <a href="https://doi.org/10.1214/17-BA1091">10.1214/17-BA1091</a>                arXiv: <a href="https://arxiv.org/abs/1704.02030">1704.02030</a></li><li class="footnote" id="footnote-YaoVehtari2018"><a class="tag is-link" href="#citeref-YaoVehtari2018">YaoVehtari2018</a>Yuling Yao, Aki Vehtari, Daniel Simpson, and Andrew Gelman.                Using Stacking to Average Bayesian Predictive Distributions.                2018. Bayesian Analysis. 13, 3, 917–1007.                doi: <a href="https://doi.org/10.1214/17-BA1091">10.1214/17-BA1091</a>                arXiv: <a href="https://arxiv.org/abs/1704.02030">1704.02030</a></li><li class="footnote" id="footnote-YaoVehtari2018"><a class="tag is-link" href="#citeref-YaoVehtari2018">YaoVehtari2018</a>Yuling Yao, Aki Vehtari, Daniel Simpson, and Andrew Gelman.                Using Stacking to Average Bayesian Predictive Distributions.                2018. Bayesian Analysis. 13, 3, 917–1007.                doi: <a href="https://doi.org/10.1214/17-BA1091">10.1214/17-BA1091</a>                arXiv: <a href="https://arxiv.org/abs/1704.02030">1704.02030</a></li><li class="footnote" id="footnote-YaoVehtari2018"><a class="tag is-link" href="#citeref-YaoVehtari2018">YaoVehtari2018</a>Yuling Yao, Aki Vehtari, Daniel Simpson, and Andrew Gelman.                Using Stacking to Average Bayesian Predictive Distributions.                2018. Bayesian Analysis. 13, 3, 917–1007.                doi: <a href="https://doi.org/10.1214/17-BA1091">10.1214/17-BA1091</a>                arXiv: <a href="https://arxiv.org/abs/1704.02030">1704.02030</a></li><li class="footnote" id="footnote-Gabry2019"><a class="tag is-link" href="#citeref-Gabry2019">Gabry2019</a>Gabry, J., Simpson, D., Vehtari, A., Betancourt, M. &amp; Gelman, A. Visualization in Bayesian Workflow. J. R. Stat. Soc. Ser. A Stat. Soc. 182, 389–402 (2019). doi: <a href="https://doi.org/10.1111/rssa.12378">10.1111/rssa.12378</a> arXiv: <a href="https://arxiv.org/abs/1709.01449">1709.01449</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« API Overview</a><a class="docs-footer-nextpage" href="../diagnostics/">Diagnostics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 19 August 2025 09:44">Tuesday 19 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
